<!DOCTYPE html><html domain="tech-blog.cymetrics.io" ga-id="G-3VBVCXV9Z0" lang="zh-TW"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="CYBER,Cymetrics,Security" name="keywords"><link href="/img/favicon/favicon-192x192.png?hash=42b087227d" rel="icon" type="image/png"><meta content="#5789d3" name="theme-color"><title>資安也要自動化 Selenium</title><meta content="資安也要自動化 Selenium" property="og:title"><meta content="資安也要自動化 Selenium" name="twitter:title"><meta content="summary" name="twitter:card"><meta content="# 前言 很多人都買過福袋，試想今天買了一個很貴的福袋，拿起來又大又重感覺很充實，但辛苦的搬回家後卻發現裡面只有一支筆是你想要的，其他都是用不到丟掉卻可惜的東西，真的令人很崩潰。..." name="description"><meta content="# 前言 很多人都買過福袋，試想今天買了一個很貴的福袋，拿起來又大又重感覺很充實，但辛苦的搬回家後卻發現裡面只有一支筆是你想要的，其他都是用不到丟掉卻可惜的東西，真的令人很崩潰。..." name="twitter:description"><meta content="# 前言 很多人都買過福袋，試想今天買了一個很貴的福袋，拿起來又大又重感覺很充實，但辛苦的搬回家後卻發現裡面只有一支筆是你想要的，其他都是用不到丟掉卻可惜的東西，真的令人很崩潰。..." property="og:description"><meta content="article" property="og:type"><meta content="https://tech-blog.cymetrics.io/posts/nick/selenuim/" property="og:url"><meta content="Cymetrics Tech Blog" property="og:site_name"><meta content="https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_1.jpg" property="og:image"><meta content="https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_1.jpg" name="twitter:image"><meta content="hsZQwAip9iIbys-i4PJp_MfpNiA6w6RB0hYdWLiLUuk" name="google-site-verification"><link href="https://tech-blog.cymetrics.io/posts/nick/selenuim/" rel="canonical"><meta content="always" name="referrer"><link href="/feed/feed.xml" rel="alternate" type="application/atom+xml" title="Cymetrics Tech Blog"><link href="/" rel="preconnect" crossorigin=""><script async="" src="/js/min.js?hash=bcb67b09df" defer=""></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3VBVCXV9Z0"></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-3VBVCXV9Z0');</script><script csp-hash="">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>:root{--primary-color: #5789d3;--primary-dark-color: #ffd349;--fgColor: #2f2f2f;--bgColor: linear-gradient(to top, #efefef, #ffffff);--primary: var(--primary-color);--primary-dark: var(--primary-dark-color);--fg: var(--fgColor);--bg: var(--bgColor);--progressColor: #ffd349;--main-width: calc(100vw - 3em)}main img{content-visibility:auto}article *{scroll-margin-top:50px}header nav{z-index:1;position:fixed;top:0;left:0;width:100vw;background:#fff;font-weight:200;text-align:right;padding:0}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px;width:50px;height:50px;border-radius:50%;overflow:hidden;box-shadow:2px 3px 5px 2px rgba(0,0,0,.2)}@media screen and (max-width:376px){share-widget{display:none}}share-widget div{margin-left:50%;transform:translateX(-50%);width:20px;height:20px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center;background-size:contain}.apple share-widget div{background-image:url(/img/share-apple.svg)}share-widget button{margin:0;padding:0;width:100%;height:100%;transition:.3s}share-widget button:active{transform:scale(1.2)}dialog{background-color:var(--primary-dark);z-index:1000;font-size:14px}#reading-progress{z-index:1;background-color:var(--progressColor);width:100vw;position:absolute;left:0;bottom:0;height:2px;transform:translate(-100vw,0);will-change:transform;pointer-events:none}#posts li{margin-bottom:.5em}html{line-height:1.15;-webkit-text-size-adjust:100%;font-family:"Open Sans",-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans","Helvetica Neue",Helvetica,Arial,"Noto Sans TC","PingFang TC","Hiragino Sans GB","Heiti TC","Microsoft YaHei","Microsoft Jhenghei",sans-serif;--font-family: "Open Sans", -apple-system, system-ui, BlinkMacSystemFont,
    "Segoe UI", Roboto, "Noto Sans", "Helvetica Neue", Helvetica, Arial,
    "Noto Sans TC", "PingFang TC", "Hiragino Sans GB", "Heiti TC",
    "Microsoft YaHei", "Microsoft Jhenghei", sans-serif}body{margin:0}body.lock{overflow:hidden}button,hr{overflow:visible}hr{box-sizing:content-box;height:0;border-bottom:1px solid var(--fg)}a{background-color:transparent;text-underline-offset:2px;text-decoration:none;color:var(--primary)}img{border-style:none;max-width:100%;height:auto;margin:0 auto}button{font-family:inherit;font-size:100%;line-height:1.15;text-transform:none}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}summary{display:list-item}h2{font-size:2.5em;line-height:1.2;margin-bottom:.6em;line-height:2.4rem;margin-bottom:1.36rem;font-size:1.728rem}h3{font-size:2em;line-height:1.125;margin-bottom:.75em;font-size:1.4rem;line-height:1.5rem;margin-bottom:1rem}body,ol,p,pre,ul{font-size:1em}ol,p,pre,ul{margin-bottom:1.5em}body,ol,p,pre,ul{font-size:1rem;line-height:1.6}ol,p,pre,ul{margin-bottom:1.36rem}@media (min-width:600px){h2{font-size:2.0097rem;line-height:2.52rem}h3{font-size:1.7989rem;line-height:2rem}body,ol,p,pre,ul{font-size:1.1rem;line-height:1.6}h2,h3,ol,p,pre,ul{margin-bottom:1.496rem}}@media (min-width:1200px){h2{font-size:2.05rem}h3{font-size:1.5rem}body,ol,p,pre,ul{font-size:1.2rem;line-height:1.6}h2,h3,ol,p,pre,ul{margin-bottom:1.632rem}}code,pre{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre code:not([class]){overflow-x:scroll}button,code{border-radius:.3em}code{color:#e33671;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%}h1,h2,h3{font-family:var(--font-family)}a:hover{text-decoration:underline}@media (max-width:767px){x:-moz-any-link{display:table-cell}}form{padding:1.5em 1.5em 0;border:.2rem solid #202020;margin-bottom:1.5em}button{max-width:100%;background:#f2f2f2;color:#191919;cursor:pointer;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}button+label,label+*{page-break-before:always}button,label{display:inline-block}form>:not(fieldset){margin-right:.75em}button:hover{background:#d9d9d9;color:#000}button:not([disabled]){background:#f9c412;color:#181818;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--primary-dark)}*,.utterances{box-sizing:border-box}*{border:0}body{font-family:var(--font-family);background:var(--bg);color:var(--fg)}header label{display:block}article,header{max-width:100%;width:42.5em;margin:0 auto}header{padding:4.5em 24px 0;text-align:center;flex-direction:column}header p,ol,ul{margin-top:0}header nav .nav-title{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav label{color:#000;cursor:pointer;margin:0;font-style:normal;text-align:right}main{max-width:70rem;margin:0 auto;min-height:60vh}article{padding:1.5em;word-break:break-word}li ol,li ul{margin-bottom:0}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;background:#2d2d2d}.token.comment{color:#999}.token.punctuation{color:#ccc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.property{color:#f8c555}.token.builtin,.token.keyword{color:#cc99cd}.token.string{color:#7ec699}.token.operator,.token.url{color:#67cdcc}.nav__links a,.token.bold{font-weight:700}.token.inserted{color:green}.utterances{position:relative;width:100%;max-width:760px;margin-left:auto;margin-right:auto}.w-full{width:100%}body.dark{--fg: var(--bgColor);--bg: var(--fgColor);--primary: var(--primary-dark-color);--paginationCurrentColor: #666356}@media (prefers-color-scheme:dark){body.dark{--fg: var(--bgColor);--bg: var(--fgColor);--primary: var(--primary-dark-color);--paginationCurrentColor: #666356}}h1{font-size:32px;line-height:1.25;margin:.67em 0;text-align:left}header aside{font-size:16px;color:#4b4b4b}.post,footer{border-top:1px solid #ccc}.post{padding-top:35px;margin-top:35px}.menu__btn{display:inline-block;width:24px;height:24px;position:relative}.menu__btn span{opacity:0;width:1px;height:1px;overflow:hidden;display:block}.menu__btn::after,.menu__btn::before{content:"";position:absolute;top:51%;left:50%;height:2px;width:17px;background-color:#2d2d2d;border-radius:.1rem}.menu__btn::before{transform:translate(-50%,-50%);box-shadow:0 .3rem 0 #2d2d2d,0 -.3rem 0 #2d2d2d}.menu__btn::after{display:none;transform:translate(-50%,-50%) rotate(90deg)}.menu__btn.menu__btn--close{z-index:9;transform:rotate(45deg)}.menu__btn.menu__btn--close::before{box-shadow:none}.menu__btn.menu__btn--close::after{display:block}#nav,#nav .nav-title,header{display:flex;align-items:center}#nav{position:relative;height:68px;z-index:2}#nav .nav-title{padding:.375rem 1.5rem;width:100%;justify-content:space-between}#nav .nav-title *,.article-footer img{margin:0}.nav__links{display:none;flex-direction:column;position:fixed;z-index:3;top:0;left:0;right:0;bottom:0;padding:86px 48px 0;background-image:linear-gradient(to top,#efefef,#fff),linear-gradient(to bottom,#f9f9f9,#f9f9f9)}.nav__links--open{display:flex}.nav__links a{text-align:left;width:100%;padding:.5rem 0;transition:all .3s ease-out;text-decoration:none;color:var(--fg)}.nav__links a:hover{color:var(--primary-color)}.nav-logo{width:260px;height:40px;background:url(/img/logo1.png) no-repeat center center;background-size:contain}footer{margin-top:48px;font-size:14px;padding:24px;text-align:center}.copyright{display:inline-block}footer>*{margin:.5em}.footer-logos{display:flex;align-items:center;justify-content:center}.footer-logos a:not(:first-child){margin-left:32px}.post-tags{display:flex;gap:0 16px;flex-wrap:wrap}.direct-link{display:none}.post-avatar{margin-top:27px;display:flex;align-items:center;height:36px}.post-avatar__img{width:36px;height:36px;overflow:hidden;margin:0;border-radius:50%}.post-avatar__time{font-size:13px}.post-avatar__info{margin-left:8px;color:#747474;text-align:left}.post-avatar__author{font-size:14px;font-weight:700}.article-footer{margin-top:40px;border-bottom:1px solid #ccc;padding-bottom:52px}.article-footer a{float:right;display:flex;align-items:center;color:var(--fg);font-weight:700;margin-left:4px}.article-author{margin-top:34px;display:flex;align-items:flex-start;margin-bottom:48px}.article-author__img{width:80px;height:80px;overflow:hidden;margin:0;border-radius:50%;flex-shrink:0}.article-author__info{margin-left:16px;text-align:left}.article-author__title{color:#747474;font-size:16px}.article-author__author{font-size:22px;font-weight:700;line-height:1em}.article-author__intro{color:#2f2f2f;margin-top:8px}@media (min-width:768px){h1{font-size:48px}header aside{font-size:20px}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}.menu__btn{display:none}#nav,footer{max-width:1168px}#nav{height:80px;margin:0 auto}.nav-logo{width:313px}.nav__links{display:flex;flex-direction:row;position:static;padding:0;background-image:none}.nav__links a{text-align:center;margin-left:56px}footer{display:flex;flex-direction:row-reverse;justify-content:space-between;align-items:center;margin-left:auto;margin-right:auto}}.notice-block{text-align:left;background:rgba(87,137,211,.2);padding:16px;margin-top:24px;border-radius:8px}</style></head><body><header><nav><div id="nav"><div class="nav-title"><a href="/" class="nav-logo" title="Homepage"></a> <label class="menu__btn" for="menu__control"><span>Menu</span></label></div><div class="nav__links"><a href="/archive/">Archive</a> <a href="/tags/">Tags</a> <a href="/about/">About</a></div></div><div id="reading-progress" aria-hidden="true"></div></nav><h1 class="w-full">資安也要自動化 Selenium</h1><aside class="w-full"><div class="post-tags"><a href="/tags/security/" class="post-tag">#Security</a> <a href="/tags/selenium/" class="post-tag">#Selenium</a> <a href="/tags/selenium-ide/" class="post-tag">#Selenium IDE</a> <a href="/tags/selenium-webdriver/" class="post-tag">#Selenium WebDriver</a> <a href="/tags/selenium-grid/" class="post-tag">#Selenium Grid</a></div><div class="post-avatar"><img alt="nick" src="/img/authors/nick_logo.jpg" class="post-avatar__img" data-deopt="true"><div class="post-avatar__info"><div class="post-avatar__author"><a href="/posts/nick">nick</a></div><div class="post-avatar__time">28 Dec 2021</div></div></div><div class="notice-block" data-nosnippet="">我們正在尋找一位 Senior Security Engineer 加入我們的團隊，詳情請參考<a href="https://github.com/cymetrics/blog/issues/6" rel="noopener noreferrer" target="_blank">職缺資訊</a></div></aside><dialog id="message"></dialog></header><main><article><div id="post-page"></div><h2 id="%E5%89%8D%E8%A8%80"><a href="#%E5%89%8D%E8%A8%80" class="direct-link">#</a> 前言</h2><p>很多人都買過福袋，試想今天買了一個很貴的福袋，拿起來又大又重感覺很充實，但辛苦的搬回家後卻發現裡面只有一支筆是你想要的，其他都是用不到丟掉卻可惜的東西，真的令人很崩潰。</p><p>當你想做特定的安全性測試，又不想只為了單一測項花大錢買整套的弱掃工具時，一個好入門又方便客製化的開源工具能給你很大的幫助，就像根據自己的手打造一支專屬的筆，多花點時間但順手，還比福袋省錢。</p><p>本文的目的就是簡單介紹一下 Selenium，在舉幾個有關網站安全測試的例子，最後分享一下使用心得。</p><hr><h2 id="selenium-%E7%B0%A1%E4%BB%8B"><a href="#selenium-%E7%B0%A1%E4%BB%8B" class="direct-link">#</a> Selenium 簡介</h2><p>Selenium 能模擬一般消費者瀏覽網頁的行為並藉此進行自動化測試，雖然它是自動化測試工具但更多人拿來做動態網頁爬蟲，因為在動態網頁抓資料時必須要模擬一些操作行為，而這正好是 Selenium 的強項。</p><h3 id="1.-selenium-ide"><a href="#1.-selenium-ide" class="direct-link">#</a> 1. Selenium IDE</h3><p>瀏覽器的擴充套件，它提供了錄製、回放、測試腳本匯入匯出功能，用於編寫功能測試，且不需要用寫程式，是使用 Selenium 進行網站自動化的基礎。</p><h3 id="2.-selenium-webdriver"><a href="#2.-selenium-webdriver" class="direct-link">#</a> 2. Selenium WebDriver</h3><p>用來執行並操作瀏覽器的一個 API 介面，程式透過呼叫 WebDriver 來直接對瀏覽器進行操作，Selenium WebDriver API 支援 Java、C#、Ruby、Python 及 Perl 等多種語言進行腳本撰寫，許多 Web Test Framework，都是以 Selenium WebDriver API 作為基礎，功能強大且穩固已經讓 Selenium 成為瀏覽器自動化的基石。</p><h3 id="3.-selenium-grid"><a href="#3.-selenium-grid" class="direct-link">#</a> 3. Selenium Grid</h3><p>主要可以讓我們輕鬆的同時使用多台機器、多個瀏覽器來對網頁進行測試。</p><hr><h2 id="%E5%88%9D%E9%9A%8E%E5%AF%A6%E4%BD%9C%E6%96%B9%E5%BC%8F%3A-selenium-ide"><a href="#%E5%88%9D%E9%9A%8E%E5%AF%A6%E4%BD%9C%E6%96%B9%E5%BC%8F%3A-selenium-ide" class="direct-link">#</a> 初階實作方式: Selenium IDE</h2><p>最簡單的自動化測試就是將手動測試時的動作紀錄起來，之後要測試的時候重新播放，省去重新手動測試的人力。因為 Selenium IDE 本質是瀏覽器的擴充套件，接下來以 Chrome 來示範對 DVWA 靶站的登入測試頁做 SQL injection 的測試(對 SQL Injection 不熟的可參考)。</p><h3 id="%E6%AD%A5%E9%A9%9F-1.-%E5%AE%89%E8%A3%9D-selenium-ide"><a href="#%E6%AD%A5%E9%A9%9F-1.-%E5%AE%89%E8%A3%9D-selenium-ide" class="direct-link">#</a> 步驟 1. 安裝 Selenium IDE</h3><ul><li><ol><li>安裝 chrome<br><a href="https://www.google.com/intl/zh-tw/chrome/" rel="noopener noreferrer" target="_blank">https://www.google.com/intl/zh-tw/chrome/</a></li></ol></li><li><ol start="2"><li>到 chrome 線上應用程式商店搜索 Selenium IDE 並安裝<br><a href="https://chrome.google.com/webstore/detail/selenium-ide/mooikfkahbdckldjjndioackbalphokd" rel="noopener noreferrer" target="_blank">https://chrome.google.com/webstore/detail/selenium-ide/mooikfkahbdckldjjndioackbalphokd</a><br><img alt="" src="/img/posts/cymetrics/selenium/se_2.jpg"></li></ol></li></ul><h3 id="%E6%AD%A5%E9%A9%9F-2.-%E8%A1%8C%E7%82%BA%E9%8C%84%E8%A3%BD"><a href="#%E6%AD%A5%E9%A9%9F-2.-%E8%A1%8C%E7%82%BA%E9%8C%84%E8%A3%BD" class="direct-link">#</a> 步驟 2. 行為錄製</h3><ul><li><ol><li>點選 Icon 開啟 Selenium IDE</li></ol><p><img alt="" src="/img/posts/cymetrics/selenium/se_3.jpg"></p></li><li><ol start="2"><li>點選 "Record a new test in a new project" 建立測試專案並指定要錄製的網站 URL</li></ol><p><img alt="" src="/img/posts/cymetrics/selenium/se_4.jpg"></p><p><img alt="" src="/img/posts/cymetrics/selenium/se_5.jpg"></p></li><li><ol start="3"><li>在彈出來的新視窗進行測試行為，這邊以 SQL injection 為例</li></ol><p><img alt="" src="/img/posts/cymetrics/selenium/se_6.jpg"></p><ul><li><ol><li>點輸入框</li></ol></li><li><ol start="2"><li>輸入 admin' or '1' = '1</li></ol></li><li><ol start="3"><li>點擊登入按鍵</li></ol></li></ul></li></ul><h3 id="%E6%AD%A5%E9%A9%9F-3.-%E9%87%8D%E6%94%BE%E6%B8%AC%E8%A9%A6"><a href="#%E6%AD%A5%E9%A9%9F-3.-%E9%87%8D%E6%94%BE%E6%B8%AC%E8%A9%A6" class="direct-link">#</a> 步驟 3. 重放測試</h3><ul><li><ol><li>重放前一步驟記錄下的測試，Selenium 會做 5 個動作</li></ol><ul><li><ol><li>開啟測試頁面</li></ol></li><li><ol start="2"><li>設定視窗大小</li></ol></li><li><ol start="3"><li>點輸入框</li></ol></li><li><ol start="4"><li>輸入 admin' or '1' = '1</li></ol></li><li><ol start="5"><li>點擊登入按鍵</li></ol></li></ul><p><img alt="" src="/img/posts/cymetrics/selenium/se_7.jpg"></p></li><li><ol start="2"><li>這時候會看到成功執行 SQL Injection 的畫面</li></ol><p><img alt="" src="/img/posts/cymetrics/selenium/se_8.jpg"></p></li><li><ol start="3"><li>最後記得存檔，瀏覽器不會幫你記錄這些，下次開啟需從存檔導入</li></ol><p><img alt="" src="/img/posts/cymetrics/selenium/se_9.jpg"></p></li></ul><hr><h2 id="%E9%80%B2%E9%9A%8E%E5%AF%A6%E4%BD%9C%E6%96%B9%E5%BC%8F%3A-selenium-webdriver"><a href="#%E9%80%B2%E9%9A%8E%E5%AF%A6%E4%BD%9C%E6%96%B9%E5%BC%8F%3A-selenium-webdriver" class="direct-link">#</a> 進階實作方式: Selenium WebDriver</h2><p>有一些無法攻擊方式較難只靠側錄來完成，像是 Brute Force 和 Buffer Overflow 等等，這時候就需要寫程式來配合 Selenium WebDriver 進行測試。接下來以 Chrome + Python 來對 iThome 做登入測試，因為選真實的網站來示範，所以只執行單次登入來證實可以用 Selenium WebDriver 做 Brute Force，而不是真的打下去。</p><h3 id="%E6%AD%A5%E9%A9%9F-1.-%E5%AE%89%E8%A3%9D-selenium-webdriver"><a href="#%E6%AD%A5%E9%A9%9F-1.-%E5%AE%89%E8%A3%9D-selenium-webdriver" class="direct-link">#</a> 步驟 1. 安裝 Selenium WebDriver</h3><p>安裝步驟就不多贅述，這邊提供下載位置與測試時的版本作為參考</p><ul><li><ol><li>Chrome (96.0.4664.110)<br><a href="https://www.google.com/intl/zh-tw/chrome/" rel="noopener noreferrer" target="_blank">https://www.google.com/intl/zh-tw/chrome/</a></li></ol></li><li><ol start="2"><li>Python (3.8.9)<br><a href="https://www.python.org/downloads/" rel="noopener noreferrer" target="_blank">https://www.python.org/downloads/</a></li></ol></li><li><ol start="3"><li>Selenium WebDriver (4.0.0)<br><code>pip install selenium</code></li></ol></li><li><ol start="4"><li>ChromeDriver (96.0.4664.45)<br><a href="https://chromedriver.chromium.org/" rel="noopener noreferrer" target="_blank">https://chromedriver.chromium.org/</a></li></ol></li><li><ol start="5"><li>(option)webdriver_manager (3.5.2)<br><code>pip install webdriver-manager</code></li></ol></li></ul><p>備註: webdriver_manager 可偵測當前系統與Chrome版本自動下載 ChromeDriver，但不是所有開發環境都通用(ex. docker)</p><h3 id="%E6%AD%A5%E9%A9%9F-2.-%E5%8F%96%E5%BE%97%E9%A0%81%E9%9D%A2%E5%85%83%E7%B4%A0"><a href="#%E6%AD%A5%E9%A9%9F-2.-%E5%8F%96%E5%BE%97%E9%A0%81%E9%9D%A2%E5%85%83%E7%B4%A0" class="direct-link">#</a> 步驟 2. 取得頁面元素</h3><ul><li><ol><li>從頁面上取得 XPath 用於定位點擊與輸入</li></ol><p><img alt="" src="/img/posts/cymetrics/selenium/se_10.jpg"></p></li></ul><h3 id="%E6%AD%A5%E9%A9%9F-3.-%E5%9F%B7%E8%A1%8C%E6%B8%AC%E8%A9%A6"><a href="#%E6%AD%A5%E9%A9%9F-3.-%E5%9F%B7%E8%A1%8C%E6%B8%AC%E8%A9%A6" class="direct-link">#</a> 步驟 3. 執行測試</h3><ul><li><ol><li>開啟瀏覽器</li></ol></li></ul><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<br><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>options <span class="token keyword">import</span> Options<br><span class="token keyword">from</span> webdriver_manager<span class="token punctuation">.</span>chrome <span class="token keyword">import</span> ChromeDriverManager<br><span class="token keyword">from</span> webdriver_manager<span class="token punctuation">.</span>utils <span class="token keyword">import</span> ChromeType<br><span class="token comment"># 0. init</span><br>chrome_options <span class="token operator">=</span> Options<span class="token punctuation">(</span><span class="token punctuation">)</span><br>chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--incognito"</span><span class="token punctuation">)</span><br><span class="token comment"># 1. set headless</span><br><span class="token keyword">if</span> headless_mode<span class="token punctuation">:</span><br>    chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--headless'</span><span class="token punctuation">)</span><br>    chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--disable-gpu'</span><span class="token punctuation">)</span><br><span class="token comment"># 2. set user-agent</span><br>ua <span class="token operator">=</span> <span class="token string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) "</span> \<br>    <span class="token string">"AppleWebKit/537.36 (KHTML, like Gecko) "</span> \<br>    <span class="token string">"Chrome/92.0.4515.159 Safari/537.36"</span><br>chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'user-agent={}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ua<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token comment"># 3. open browser</span><br>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>ChromeDriverManager<span class="token punctuation">(</span>chrome_type<span class="token operator">=</span>ChromeType<span class="token punctuation">.</span>CHROMIUM<span class="token punctuation">)</span><span class="token punctuation">.</span>install<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>                          options<span class="token operator">=</span>chrome_options<span class="token punctuation">)</span><br>driver<span class="token punctuation">.</span>set_window_size<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">768</span><span class="token punctuation">)</span><br></code></pre><ul><li><ol start="2"><li>設計動作</li></ol></li></ul><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By<br><br><span class="token keyword">try</span><span class="token punctuation">:</span><br>    driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><br>    driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>input_url<span class="token punctuation">)</span><br>    <span class="token keyword">for</span> temp_action <span class="token keyword">in</span> input_action_list<span class="token punctuation">:</span><br>        <span class="token keyword">if</span> temp_action<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'click'</span><span class="token punctuation">:</span><br>            driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> temp_action<span class="token punctuation">[</span><span class="token string">'xpath'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token keyword">if</span> temp_action<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'write'</span><span class="token punctuation">:</span><br>            driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> temp_action<span class="token punctuation">[</span><span class="token string">'xpath'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>temp_action<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token keyword">except</span> Exception <span class="token keyword">as</span> ex<span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Exception:'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token keyword">finally</span><span class="token punctuation">:</span><br>    driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span><br></code></pre><ul><li><ol start="3"><li>啟動測試(完整程式碼)</li></ol></li></ul><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<br><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>options <span class="token keyword">import</span> Options<br><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By<br><span class="token keyword">from</span> webdriver_manager<span class="token punctuation">.</span>chrome <span class="token keyword">import</span> ChromeDriverManager<br><span class="token keyword">from</span> webdriver_manager<span class="token punctuation">.</span>utils <span class="token keyword">import</span> ChromeType<br><br><span class="token keyword">def</span> <span class="token function">selenium_chrome_demo</span><span class="token punctuation">(</span>input_url<span class="token punctuation">,</span> input_action_list<span class="token punctuation">,</span> headless_mode<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>    <span class="token comment"># 0. init</span><br>    chrome_options <span class="token operator">=</span> Options<span class="token punctuation">(</span><span class="token punctuation">)</span><br>    chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"--incognito"</span><span class="token punctuation">)</span><br>    <span class="token comment"># 1. set headless</span><br>    <span class="token keyword">if</span> headless_mode<span class="token punctuation">:</span><br>        chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--headless'</span><span class="token punctuation">)</span><br>        chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--disable-gpu'</span><span class="token punctuation">)</span><br>    <span class="token comment"># 2. set user-agent</span><br>    ua <span class="token operator">=</span> <span class="token string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) "</span> \<br>         <span class="token string">"AppleWebKit/537.36 (KHTML, like Gecko) "</span> \<br>         <span class="token string">"Chrome/92.0.4515.159 Safari/537.36"</span><br>    chrome_options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'user-agent={}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ua<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token comment"># 3. open browser</span><br>    driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>ChromeDriverManager<span class="token punctuation">(</span>chrome_type<span class="token operator">=</span>ChromeType<span class="token punctuation">.</span>CHROMIUM<span class="token punctuation">)</span><span class="token punctuation">.</span>install<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>                              options<span class="token operator">=</span>chrome_options<span class="token punctuation">)</span><br>    driver<span class="token punctuation">.</span>set_window_size<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">768</span><span class="token punctuation">)</span><br>    <span class="token comment"># 4. run action</span><br>    <span class="token keyword">try</span><span class="token punctuation">:</span><br>        driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><br>        driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>input_url<span class="token punctuation">)</span><br>        <span class="token keyword">for</span> temp_action <span class="token keyword">in</span> input_action_list<span class="token punctuation">:</span><br>            <span class="token keyword">if</span> temp_action<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'click'</span><span class="token punctuation">:</span><br>                driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> temp_action<span class="token punctuation">[</span><span class="token string">'xpath'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span><br>            <span class="token keyword">if</span> temp_action<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'write'</span><span class="token punctuation">:</span><br>                driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span> temp_action<span class="token punctuation">[</span><span class="token string">'xpath'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>temp_action<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> ex<span class="token punctuation">:</span><br>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Exception:'</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token keyword">finally</span><span class="token punctuation">:</span><br>        driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token keyword">return</span><br><br>test_json_list <span class="token operator">=</span> <span class="token punctuation">[</span><br><span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'write'</span><span class="token punctuation">,</span> <span class="token string">'xpath'</span><span class="token punctuation">:</span> <span class="token string">'//*[@id="account"]'</span><span class="token punctuation">,</span> <span class="token string">'text'</span><span class="token punctuation">:</span> <span class="token string">'account'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'write'</span><span class="token punctuation">,</span> <span class="token string">'xpath'</span><span class="token punctuation">:</span> <span class="token string">'//*[@id="password"]'</span><span class="token punctuation">,</span> <span class="token string">'text'</span><span class="token punctuation">:</span> <span class="token string">'password'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><br><span class="token punctuation">{</span><span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token string">'xpath'</span><span class="token punctuation">:</span> <span class="token string">'/html/body/div/div/div/form/button'</span><span class="token punctuation">,</span> <span class="token string">'text'</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">}</span><span class="token punctuation">]</span><br><br>selenium_chrome_demo<span class="token punctuation">(</span>input_url<span class="token operator">=</span><span class="token string">"https://member.ithome.com.tw/login"</span><span class="token punctuation">,</span><br>                     input_action_list<span class="token operator">=</span>test_json_list<span class="token punctuation">)</span><br></code></pre><p>因為帳號跟密碼是隨便寫的理論上會看到這各畫面</p><p><img alt="" src="/img/posts/cymetrics/selenium/se_11.jpg"></p><h2 id="%E9%AB%98%E9%9A%8E%E5%AF%A6%E4%BD%9C%E6%96%B9%E5%BC%8F%3A-selenium-grid"><a href="#%E9%AB%98%E9%9A%8E%E5%AF%A6%E4%BD%9C%E6%96%B9%E5%BC%8F%3A-selenium-grid" class="direct-link">#</a> 高階實作方式: Selenium Grid</h2><p>如果要更進一步建立一個平台來控管 Selenium 的自動化測試，官方就有提供解決方案 Selenium Grid，其中管理平台稱為 Hub，實際運行測試的稱為 Node</p><p><img alt="" src="/img/posts/cymetrics/selenium/se_12.jpg"><br>圖片來源: <a href="https://www.edureka.co/blog/selenium-grid-tutorial" rel="noopener noreferrer" target="_blank">https://www.edureka.co/blog/selenium-grid-tutorial</a></p><h3 id="%E6%AD%A5%E9%A9%9F-1.-%E5%AE%89%E8%A3%9D-selenium-grid"><a href="#%E6%AD%A5%E9%A9%9F-1.-%E5%AE%89%E8%A3%9D-selenium-grid" class="direct-link">#</a> 步驟 1. 安裝 Selenium Grid</h3><p>Selenium Grid 安裝與串接推薦用 docker</p><ul><li><ol><li>建立串接用的網路(Bridge)</li></ol></li></ul><pre><code>$ docker network create grid
</code></pre><ul><li><ol start="2"><li>安裝 hub</li></ol></li></ul><pre><code>$ docker run -d -p 4442-4444:4442-4444 --net grid --name selenium-hub selenium/hub:4.1.1-20211217
</code></pre><ul><li><ol start="3"><li>安裝 node</li></ol></li></ul><pre><code>$ docker run -d --net grid -e SE_EVENT_BUS_HOST=selenium-hub \
    --shm-size="2g" \
    -e SE_EVENT_BUS_PUBLISH_PORT=4442 \
    -e SE_EVENT_BUS_SUBSCRIBE_PORT=4443 \
    selenium/node-chrome:4.1.1-20211217
</code></pre><h3 id="%E6%AD%A5%E9%A9%9F-2.-node-%E8%A8%AD%E5%AE%9A"><a href="#%E6%AD%A5%E9%A9%9F-2.-node-%E8%A8%AD%E5%AE%9A" class="direct-link">#</a> 步驟 2. node 設定</h3><p>node 的本質就是一個幫你安裝好 Selenium WebDriver 的 Ubuntu VM，部份 Selenium 會用到的套件已經裝在裡面了，可以省掉不少架環境的時間</p><ul><li><ol><li>進入 node 的 container</li></ol><p><code>docker exec -i -t your_node /bin/bash</code></p><p><img alt="" src="/img/posts/cymetrics/selenium/se_13.jpg"></p></li><li><ol start="2"><li>建立測試<br>可參考 Selenium WebDriver 的實作方式建立測試，然後將我們之前準備好確未用到的功能 headless 打開，就可以在 node 裡面跑測試了</li></ol></li></ul><pre class="language-python"><code class="language-python"> selenium_chrome_demo<span class="token punctuation">(</span>input_url<span class="token operator">=</span><span class="token string">"https://member.ithome.com.tw/login"</span><span class="token punctuation">,</span><br>                     input_action_list<span class="token operator">=</span>test_json_list<span class="token punctuation">,</span><br>                     headless_mode<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre><ul><li><ol start="3"><li>(option) docker 版本預設開啟 VNC server，可藉此連去調整設定或建立測試<br><img alt="" src="/img/posts/cymetrics/selenium/se_14.jpg"></li></ol></li></ul><h3 id="%E6%AD%A5%E9%A9%9F-3.-%E5%BE%9E-hub-%E6%AA%A2%E8%A6%96%E6%B8%AC%E8%A9%A6%E7%B5%90%E6%9E%9C"><a href="#%E6%AD%A5%E9%A9%9F-3.-%E5%BE%9E-hub-%E6%AA%A2%E8%A6%96%E6%B8%AC%E8%A9%A6%E7%B5%90%E6%9E%9C" class="direct-link">#</a> 步驟 3. 從 hub 檢視測試結果</h3><p><img alt="" src="/img/posts/cymetrics/selenium/se_15.jpg"></p><h2 id="%E7%B8%BD%E7%B5%90"><a href="#%E7%B8%BD%E7%B5%90" class="direct-link">#</a> 總結</h2><p>Selenium 在安全性測試上有他優勢或強大的地方，但是也有從實作過程中較難表現出來的缺點，所以實際運用在資安領運通常要看測試對象的特性來決定。</p><p>先提一下 Selenium 整體的優缺點，Selenium 在自動化的部分非常強大，可以錄製也可以使用 Script，而且因為是透過瀏覽器來執行動作，被網站判斷是自動化程式而導致被屏蔽的機會也比較低，但缺點就是部份設定細節無法自訂，像是 header 無法自訂導致從 header 發起的攻擊無法實作。</p><p>Selenium IDE 的優點是設定簡單、測試過程與結果較直觀、不需要 Codeing，總體來說就是開發成本很低，非常適合開發速度較快的團隊，但特有的缺點是無法排程，還是需要一定程度的人力介入，</p><p>Selenium WebDriver 的泛用性很高，不管是動態還是靜態的網站都能進行攻擊測試，個人認為是三者中最好用的，除了共同的缺點以外，硬要說缺點的話就是改版(4.0.x)後向下兼容性不佳，部分舊版程式碼無法沿用。</p><p>Selenium Grid 的優點是可以規模化，但實際執行安全性測試的時候基本上是跟 Selenium WebDriver 一樣的，所以優缺點很類似，跟其他兩者相比的缺點則是架設較為複雜，如果使用 docker 的狀況下使用 Gitlab，jenkins 等管理平台可能還更適合大部分的狀況。</p><p>前面為快速說明原理挑了一些簡單易懂的攻擊來示範，實際上還有更多更進階的用法，如果閱覽數量夠多，之後會再加開一篇分享一些更進階的用法與經典案例，有任何資安方面相關的問題都歡迎留言討論，或者直接到 Cymetrics 尋求協助。</p><div class="article-footer"><a href="https://tech-blog.cymetrics.io/posts/nick/selenuim/" on-click="share"><img alt="Share" src="/img/icons/icon_external link hyperlink.svg" height="24" width="24">Share this post</a></div><div><p style="font-weight: bold;">Tag</p><div class="post-tags"><a href="/tags/security/" class="post-tag">#Security</a> <a href="/tags/selenium/" class="post-tag">#Selenium</a> <a href="/tags/selenium-ide/" class="post-tag">#Selenium IDE</a> <a href="/tags/selenium-webdriver/" class="post-tag">#Selenium WebDriver</a> <a href="/tags/selenium-grid/" class="post-tag">#Selenium Grid</a></div><p style="font-weight: bold;">Recommendation</p><ol><li><a href="/posts/crystal/pwn-intro-2/">PWN 入門 - rop, gadget 是什麼？</a></li><li><a href="/posts/huli/prototype-pollution/">基於 JS 原型鏈的攻擊手法：Prototype Pollution</a></li><li><a href="/posts/nick/website-go-live-attack/">為什麼網站才剛上線就被攻擊？</a></li><li><a href="/posts/jo/zerobased-cross-site-scripting/">零基礎資安系列（二）-認識 XSS（Cross-Site Scripting）</a></li><li><a href="/posts/genchilu/the-difference-between-java-and-golang-in-writing-concurrent-code-to-access-shared-variable-en/">The Difference Between Java and Golang in Writing Concurrent Code to Access Shared Variable</a></li></ol></div><div class="article-author"><img alt="nick" src="/img/authors/nick_logo.jpg" class="article-author__img" data-deopt="true"><div class="article-author__info"><div class="article-author__title">Author</div><div class="article-author__author"><a href="/posts/nick">nick</a></div><div class="article-author__intro">Security</div></div></div><p style="font-weight: bold;">Discussion(login required)</p><script async="" src="https://utteranc.es/client.js" crossorigin="anonymous" id="utterance-script" issue-term="title" label="utterance" repo="cymetrics/blog" theme="github-light"></script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"資安也要自動化 Selenium","image":["https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_2.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_3.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_4.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_5.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_6.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_7.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_8.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_9.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_10.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_11.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_12.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_13.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_14.jpg","https://tech-blog.cymetrics.io/img/posts/cymetrics/selenium/se_15.jpg","https://tech-blog.cymetrics.io/img/icons/icon_external link hyperlink.svg","https://tech-blog.cymetrics.io/img/authors/nick_logo.jpg"],"author":{"@type":"Person","name":"nick"},"publisher":{"@type":"Organization","name":"Cymetrics Tech Blog","url":"https://tech-blog.cymetrics.io","logo":{"@type":"ImageObject","url":"https://tech-blog.cymetrics.io/img/favicon/favicon-512x512.png","width":512,"height":512}},"url":"https://tech-blog.cymetrics.io/posts/nick/selenuim/","mainEntityOfPage":"https://tech-blog.cymetrics.io/posts/nick/selenuim/","datePublished":"2021-12-28","dateModified":"2021-12-28","description":"# 前言 很多人都買過福袋，試想今天買了一個很貴的福袋，拿起來又大又重感覺很充實，但辛苦的搬回家後卻發現裡面只有一支筆是你想要的，其他都是用不到丟掉卻可惜的東西，真的令人很崩潰。..."}</script></article></main><footer><div class="footer-logos"><a href="https://www.facebook.com/Cymetrics-100957872049641" rel="noopener noreferrer" target="_blank"><img alt="facebook" src="/img/icons/icon_social media_facebook.svg" height="30" width="30"></a><a href="https://www.linkedin.com/company/onedegree-hk" rel="noopener noreferrer" target="_blank"><img alt="linkedin" src="/img/icons/icon_social media_linkedln.svg" height="30" width="30"></a><a href="https://tech-blog.cymetrics.io/feed/feed.xml" rel="noreferrer noopener" target="_blank"><img alt="rss feed" src="/img/icons/rss-feed.svg" height="30" width="30"></a></div><div class="copyright">© 2021 Cymetrics Tech Blog, based on <a href="https://github.com/google/eleventy-high-performance-blog" rel="noopener noreferrer" target="_blank">eleventy-high-performance-blog</a></div></footer><script>// light/dark theme switch
      // disable dark mode for now
      const menuBtn = document.querySelector('.menu__btn')
      menuBtn.addEventListener('click', function() {
        document.querySelector('body').classList.toggle('lock')
        menuBtn.classList.toggle('menu__btn--close');
        document.querySelector('.nav__links').classList.toggle('nav__links--open')
      })
      

      /*
      const toggleEl = document.querySelector('#color-scheme-toggle')
      const bodyEl = document.querySelector('body');
      const DARK = 'dark';
      const LIGHT = 'light';
      const currentTheme = localStorage.getItem("theme") ||
            (window.matchMedia('(prefers-color-scheme: dark)').matches ? DARK : LIGHT);
      setTheme(currentTheme)

      toggleEl.addEventListener("click", handleToggleEvent)

      function handleToggleEvent(){
        const isDark = bodyEl.classList.toggle(DARK);
        const theme = isDark ? DARK : LIGHT;
        setTheme(theme)
        localStorage.setItem('theme', theme);
      }
      function setTheme(theme){
        if (theme === DARK) {
          setUtterancesTheme(DARK)
          bodyEl.classList.add(DARK);
          toggleEl.src = toggleEl.src.replace(DARK, LIGHT);
        }else{
          setUtterancesTheme(LIGHT)
          toggleEl.src = toggleEl.src.replace(LIGHT, DARK);
        }
      }

      var isUtterancesLoaded = false
      window.addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') {
          return;
        }
        isUtterancesLoaded = true
      });

      function setUtterancesTheme(theme) {
        let utterancesIframe = document.querySelector('.utterances iframe')
        if (!isUtterancesLoaded) {
          return requestAnimationFrame(() => setUtterancesTheme(theme))
        }

        utterancesIframe.contentWindow.postMessage({
          type: 'set-theme',
          theme: theme === DARK ? 'github-dark-orange' : 'github-light'
        }, 'https://utteranc.es');
      }
    */</script></body></html>