<!DOCTYPE html><html domain="tech-blog.cymetrics.io" ga-id="G-3VBVCXV9Z0" lang="zh-TW"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="CYBER,Cymetrics,Security" name="keywords"><link href="/img/favicon/favicon-192x192.png?hash=42b087227d" rel="icon" type="image/png"><meta content="#5789d3" name="theme-color"><title>DNS Hacking 小番外之：談談 zone walk</title><meta content="DNS Hacking 小番外之：談談 zone walk" property="og:title"><meta content="DNS Hacking 小番外之：談談 zone walk" name="twitter:title"><meta content="summary_large_image" name="twitter:card"><meta content="如前一篇提過的，前陣子為了快速且大量掃描網域相關的問題，我寫了個自動化工具來找 zone transfer、zone walk、subdomain takeover 等問題，其中在測試 zone walk 的時候發現了關於業界防治 zone walk 的一個有趣的現象，所以想寫一個短篇聊聊。" name="description"><meta content="如前一篇提過的，前陣子為了快速且大量掃描網域相關的問題，我寫了個自動化工具來找 zone transfer、zone walk、subdomain takeover 等問題，其中在測試 zone walk 的時候發現了關於業界防治 zone walk 的一個有趣的現象，所以想寫一個短篇聊聊。" name="twitter:description"><meta content="如前一篇提過的，前陣子為了快速且大量掃描網域相關的問題，我寫了個自動化工具來找 zone transfer、zone walk、subdomain takeover 等問題，其中在測試 zone walk 的時候發現了關於業界防治 zone walk 的一個有趣的現象，所以想寫一個短篇聊聊。" property="og:description"><meta content="article" property="og:type"><meta content="https://tech-blog.cymetrics.io/posts/crystal/dns-hacking-zone-walk/" property="og:url"><link href="https://tech-blog.cymetrics.io/posts/crystal/dns-hacking-zone-walk/" rel="canonical"><meta content="Cymetrics Tech Blog" property="og:site_name"><meta content="https://tech-blog.cymetrics.io/img/posts/crystal/dns-hacking/dns-hacking-zone-walk.jpg" property="og:image"><meta content="https://tech-blog.cymetrics.io/img/posts/crystal/dns-hacking/dns-hacking-zone-walk.jpg" name="twitter:image"><meta content="hsZQwAip9iIbys-i4PJp_MfpNiA6w6RB0hYdWLiLUuk" name="google-site-verification"><meta content="always" name="referrer"><link href="/feed/feed.xml" rel="alternate" type="application/atom+xml" title="Cymetrics Tech Blog"><link href="/" rel="preconnect" crossorigin=""><script async="" src="/js/min.js?hash=7f26b2ece8" defer=""></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3VBVCXV9Z0"></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-3VBVCXV9Z0');</script><script csp-hash="">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>:root{--primary-color: #5789d3;--primary-dark-color: #ffd349;--fgColor: #2f2f2f;--bgColor: linear-gradient(to top, #efefef, #ffffff);--primary: var(--primary-color);--primary-dark: var(--primary-dark-color);--fg: var(--fgColor);--bg: var(--bgColor);--progressColor: #ffd349;--main-width: calc(100vw - 3em)}main img{content-visibility:auto}article *{scroll-margin-top:50px}header nav{z-index:1;position:fixed;top:0;left:0;width:100vw;background:#fff;font-weight:200;text-align:right;padding:0}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px;width:50px;height:50px;border-radius:50%;overflow:hidden;box-shadow:2px 3px 5px 2px rgba(0,0,0,.2)}@media screen and (max-width:376px){share-widget{display:none}}share-widget div{margin-left:50%;transform:translateX(-50%);width:20px;height:20px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center;background-size:contain}.apple share-widget div{background-image:url(/img/share-apple.svg)}share-widget button{margin:0;padding:0;width:100%;height:100%;transition:.3s}share-widget button:active{transform:scale(1.2)}dialog{background-color:var(--primary-dark);z-index:1000;font-size:14px}#reading-progress{z-index:1;background-color:var(--progressColor);width:100vw;position:absolute;left:0;bottom:0;height:2px;transform:translate(-100vw,0);will-change:transform;pointer-events:none}#posts li{margin-bottom:.5em}button,html{line-height:1.15}html{-webkit-text-size-adjust:100%;font-family:"Open Sans",-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans","Helvetica Neue",Helvetica,Arial,"Noto Sans TC","PingFang TC","Hiragino Sans GB","Heiti TC","Microsoft YaHei","Microsoft Jhenghei",sans-serif;--font-family: "Open Sans", -apple-system, system-ui, BlinkMacSystemFont,
    "Segoe UI", Roboto, "Noto Sans", "Helvetica Neue", Helvetica, Arial,
    "Noto Sans TC", "PingFang TC", "Hiragino Sans GB", "Heiti TC",
    "Microsoft YaHei", "Microsoft Jhenghei", sans-serif}body{margin:0}body.lock{overflow:hidden}a{background-color:transparent;text-underline-offset:2px;text-decoration:none;color:var(--primary)}strong{font-weight:700}img{border-style:none;max-width:100%;height:auto;margin:0 auto}button{font-family:inherit;font-size:100%;overflow:visible;text-transform:none}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}h2{font-size:2.5em;line-height:1.2;margin-bottom:.6em;line-height:2.4rem;margin-bottom:1.36rem;font-size:1.728rem}body,ol,p,pre{font-size:1em}ol,p,pre{margin-bottom:1.5em}body,ol,p,pre{font-size:1rem;line-height:1.6}ol,p,pre{margin-bottom:1.36rem}@media (min-width:600px){h2{font-size:2.0097rem;line-height:2.52rem}body,ol,p,pre{font-size:1.1rem;line-height:1.6}h2,ol,p,pre{margin-bottom:1.496rem}}@media (min-width:1200px){h2{font-size:2.05rem}body,ol,p,pre{font-size:1.2rem;line-height:1.6}h2,ol,p,pre{margin-bottom:1.632rem}}th{font-weight:600}td,th{border-bottom:1px solid #595959;overflow:auto;padding:.75em;text-align:left;vertical-align:top}thead th{border-bottom:1px solid #f9c412}table{display:table}code,pre,table{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre code:not([class]){overflow-x:scroll}button,code{border-radius:.3em}code{color:#e33671;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%}h1,h2{font-family:var(--font-family)}a:hover{text-decoration:underline}button{max-width:100%;background:#f2f2f2;color:#191919;cursor:pointer;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}button+label,label+*{page-break-before:always}button,label{display:inline-block}button:hover{background:#d9d9d9;color:#000}button:not([disabled]){background:#f9c412;color:#181818;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--primary-dark)}*{border:0;box-sizing:border-box}body{font-family:var(--font-family);background:var(--bg);color:var(--fg)}header label{display:block}article,header{max-width:100%;width:42.5em;margin:0 auto}header{padding:4.5em 24px 0;text-align:center;display:flex;align-items:center;flex-direction:column}header p,ol{margin-top:0}header nav .nav-title{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav label{color:#000;cursor:pointer;margin:0;font-style:normal;text-align:right}main{max-width:70rem;margin:0 auto;min-height:60vh}article{padding:1.5em;word-break:break-word}li ol{margin-bottom:0}blockquote{padding:0 1.5em;margin:1.5em 0 1.5em 1.5em;border-left:4px solid var(--primary)}blockquote footer{background:0 0;display:block;color:#ccc;padding:.75em 0;font-size:90%;text-align:start}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.comment{color:#999}.token.punctuation{color:#ccc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.property{color:#f8c555}.token.builtin,.token.keyword{color:#cc99cd}.token.string{color:#7ec699}.token.operator,.token.url{color:#67cdcc}.token.bold{font-weight:700}.token.inserted{color:green}::-webkit-scrollbar-thumb:hover{background:var(--primary)}.w-full{width:100%}body.dark{--fg: var(--bgColor);--bg: var(--fgColor);--primary: var(--primary-dark-color)}@media (prefers-color-scheme:dark){body.dark{--fg: var(--bgColor);--bg: var(--fgColor);--primary: var(--primary-dark-color)}}h1{font-size:32px;line-height:1.25;margin:.67em 0;text-align:left}header aside{font-size:16px;color:#4b4b4b}.post,footer{border-top:1px solid #ccc}.post{padding-top:35px;margin-top:35px}.menu__btn{display:inline-block;width:24px;height:24px;position:relative}.menu__btn span{opacity:0;width:1px;height:1px;overflow:hidden;display:block}.menu__btn::after,.menu__btn::before{content:"";position:absolute;top:51%;left:50%;height:2px;width:17px;background-color:#2d2d2d;border-radius:.1rem}.menu__btn::before{transform:translate(-50%,-50%);box-shadow:0 .3rem 0 #2d2d2d,0 -.3rem 0 #2d2d2d}.menu__btn::after{display:none;transform:translate(-50%,-50%) rotate(90deg)}.menu__btn.menu__btn--close{z-index:9;transform:rotate(45deg)}.menu__btn.menu__btn--close::before{box-shadow:none}.menu__btn.menu__btn--close::after{display:block}#nav,#nav .nav-title{display:flex;align-items:center}#nav{position:relative;height:68px;z-index:2}#nav .nav-title{padding:.375rem 1.5rem;width:100%;justify-content:space-between}#nav .nav-title *,.article-footer img{margin:0}.nav__links{display:none;flex-direction:column;position:fixed;z-index:3;top:0;left:0;right:0;bottom:0;padding:86px 48px 0;background-image:linear-gradient(to top,#efefef,#fff),linear-gradient(to bottom,#f9f9f9,#f9f9f9)}.nav__links--open{display:flex}.nav__links a{text-align:left;width:100%;padding:.5rem 0;transition:all .3s ease-out;font-weight:700;text-decoration:none;color:var(--fg)}.nav__links a:hover{color:var(--primary-color)}.nav-logo{width:260px;height:40px;background:url(/img/logo1.png) no-repeat center center;background-size:contain}footer{margin-top:48px;font-size:14px;padding:24px;text-align:center}.copyright{display:inline-block}footer>*{margin:.5em}.footer-logos{display:flex;align-items:center;justify-content:center}.footer-logos a:not(:first-child){margin-left:32px}.post-tags{display:flex;gap:0 16px;flex-wrap:wrap}.direct-link{display:none}.post-avatar{margin-top:27px;display:flex;align-items:center;height:36px}.post-avatar__img{width:36px;height:36px;overflow:hidden;margin:0;border-radius:50%}.post-avatar__time{font-size:13px}.post-avatar__info{margin-left:8px;color:#747474;text-align:left}.post-avatar__author{font-size:14px;font-weight:700}.article-footer{margin-top:40px;border-bottom:1px solid #ccc;padding-bottom:52px}.article-footer a{float:right;display:flex;align-items:center;color:var(--fg);font-weight:700;margin-left:4px}.article-author{margin-top:34px;display:flex;align-items:flex-start;margin-bottom:48px}.article-author__img{width:80px;height:80px;overflow:hidden;margin:0;border-radius:50%;flex-shrink:0}.article-author__info{margin-left:16px;text-align:left}.article-author__title{color:#747474;font-size:16px}.article-author__author{font-size:22px;font-weight:700;line-height:1em}.article-author__intro{color:#2f2f2f;margin-top:8px}@media (min-width:768px){h1{font-size:48px}header aside{font-size:20px}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}.menu__btn{display:none}#nav,footer{max-width:1168px}#nav{height:80px;margin:0 auto}.nav-logo{width:313px}.nav__links{display:flex;flex-direction:row;position:static;padding:0;background-image:none}.nav__links a{text-align:center;margin-left:56px}footer{display:flex;flex-direction:row-reverse;justify-content:space-between;align-items:center;margin-left:auto;margin-right:auto}}.notice-block{text-align:left;background:rgba(87,137,211,.2);padding:16px;margin-top:24px;border-radius:8px}</style></head><body><header><nav><div id="nav"><div class="nav-title"><a href="/" class="nav-logo" title="Homepage"></a> <label class="menu__btn" for="menu__control"><span>Menu</span></label></div><div class="nav__links"><a href="/archive/">Archive</a> <a href="/tags/">Tags</a> <a href="/about/">About</a> <a href="/en">English</a></div></div><div id="reading-progress" aria-hidden="true"></div></nav><h1 class="w-full">DNS Hacking 小番外之：談談 zone walk</h1><aside class="w-full"><div class="post-tags"><a href="/tags/security/" class="post-tag">#Security</a> <a href="/tags/dns/" class="post-tag">#DNS</a></div><div class="post-avatar"><img alt="crystal" src="/img/authors/crystal_logo.png" class="post-avatar__img" data-deopt="true"><div class="post-avatar__info"><div class="post-avatar__author"><a href="/posts/crystal">crystal</a></div><div class="post-avatar__time">25 Mar 2022</div></div></div><div class="notice-block" data-nosnippet="" style="display:none;">我們正在尋找一位 Security Engineer 加入我們的團隊，詳情請參考<a href="https://github.com/cymetrics/blog/issues/13" rel="noopener noreferrer" target="_blank">職缺資訊</a></div></aside><dialog id="message"></dialog></header><main><article><div id="post-page"></div><p>如前一篇提過的，前陣子為了快速且大量掃描網域相關的問題，我寫了個自動化工具來找 zone transfer、zone walk、subdomain takeover 等問題，其中在測試 zone walk 的時候發現了關於業界防治 zone walk 的一個有趣的現象，所以想寫一個短篇聊聊。</p><h2 id="zone-walk-recap"><a href="#zone-walk-recap" class="direct-link">#</a> zone walk recap</h2><p>關於 zone walk 的原理，這裡簡單再複習一下。</p><p>為了補足傳統 DNS 不符合完整性的問題，發展出以數位簽章方式建構信任鍊的 DNSSEC 機制，從此每一筆紀錄都會有另一筆紀錄『背書』，類似網路憑證的原理來證明 DNS 紀錄的可信度。但是， DNSSEC 只能保證『你拿到的是真的』而不能保證『你沒拿到是真的沒有』而不是被惡意丟包。為了支援 DNSSEC 的這個小小的不足，並達到真正的、正負面陳述都滿足的完整性，衍生出了一種新紀錄：NSEC。</p><p>NSEC 利用標示端點的方式，宣稱『在 A 到 B 的區間內不存在任何網域』，也就是說如果 <code>cymetrics.com</code> 的 zone 裡只有四個子網域，前綴分別為 crystal, huli, jo, nick，那就會 sort 後用一個類似 linked list 的方式把他們轉成下面這樣，之後當有人來詢問的不存在的網域時（例如 <code>david.cymetrics.io</code>），我會給他下列第二筆紀錄，表達『 crystal 的下一個是 huli，中間沒有別人了』：</p><pre class="language-txt"><code class="language-txt">cymetrics.com.          300	IN	NSEC	crystal.cymetrics.com.    A SOA RRSIG NSEC<br>crystal.cymetrics.com.  300	IN	NSEC	huli.cymetrics.com.       A NS RRSIG NSEC<br>huli.cymetrics.com.     300	IN	NSEC	jo.cymetrics.com.         A MX RRSIG NSEC<br>jo.cymetrics.com.       300	IN	NSEC	nick.cymetrics.com.       A TXT RRSIG NSEC<br>nick.cymetrics.com.     300	IN	NSEC	cymetrics.com.            A TXT RRSIG NSEC</code></pre><p>但是這樣有一個很大的問題，那就是我只要沿這著個 linked list 一直爬，就可以得到這個 zone 下面所有的網域，要枚舉簡直輕而易舉！用了 DNSSEC 之後反而把資訊通通告訴別人了，藏都藏不住，簡直得不償失。</p><p>為了應付這個問題，NSEC3 誕生了，利用 hash 把真正的網域名用一層面具藏起來，這樣就算駭客可以爬出所有的結果，也都是看不懂的東西！</p><p>NSEC3 版本（hash 只是示意，一般不會這麼短的 XDDD）：</p><pre class="language-txt"><code class="language-txt">FOS7E3K     300	IN	NSEC    1 0 10 1234567890ABCDEF     LCA56W1     A SOA RRSIG NSEC<br>LCA56W1     300	IN	NSEC    1 0 10 1234567890ABCDEF     O8H5F0P     A TXT RRSIG NSEC<br>O8H5F0P     300	IN	NSEC    1 0 10 1234567890ABCDEF     QEE453Y     A NS RRSIG NSEC<br>QEE453Y     300	IN	NSEC    1 0 10 1234567890ABCDEF     VS75HE2     A MX RRSIG NSEC<br>VS75HE2     300	IN	NSEC    1 0 10 1234567890ABCDEF     FOS7E3K     A TXT RRSIG NSEC</code></pre><p>不過這方法也是治標不治本，畢竟駭客也可以 hash 好一張很大的彩虹表，然後再一一比對找出本來的網域名稱，尤其網域命名通常都是有含義的，例如用產品名稱（<code>vpn.</code>、<code>cms.</code>）、環境名稱（<code>internal.</code>、<code>dev.</code>、<code>test.</code>）、公司簡寫等再搭配數字或其他變化，其實是很容易 fuzz 出來的。</p><p>不過無妨，現實總是不完美的。在知道了以上的機制後，我們可以寫一個簡單的程式去實作 zone walk。</p><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">zone_walk</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    doms <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <br>    <span class="token comment"># zone 沒有用 DNSSEC 或 NSEC3, 不做 zone walk </span><br>    ans <span class="token operator">=</span> query_record<span class="token punctuation">(</span>domain<span class="token punctuation">,</span> <span class="token string">"DNSKEY"</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span><br>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Not using DNSSEC, no zone walk possible!'</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span> doms<br>    <br>    <span class="token comment"># zone 用 NSEC3, 不做 zone walk</span><br>    ans <span class="token operator">=</span> query_record<span class="token punctuation">(</span>domain<span class="token punctuation">,</span> <span class="token string">"NSEC3PARAM"</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span><br>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Using NSEC3, not vulnerable to zone walk! If you would like to traverse zone and crack hashes, use nsec3walker instead.'</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span> doms<br><br>    doms <span class="token operator">=</span> <span class="token punctuation">[</span>domain<span class="token punctuation">]</span><br>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span><br>        ans <span class="token operator">=</span> query_record<span class="token punctuation">(</span>domain<span class="token punctuation">,</span> <span class="token string">"NSEC"</span><span class="token punctuation">)</span><br>        <span class="token comment"># zone 用 DNSSEC, 但沒有簽任何 NSEC ？？</span><br>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span><br>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] No NSEC record found!'</span><span class="token punctuation">)</span><br>            <span class="token keyword">return</span> doms<br>        <br>        nextdom <span class="token operator">=</span> ans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><br>        <span class="token keyword">if</span> nextdom <span class="token operator">==</span> doms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span><br>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Finished zone walk'</span><span class="token punctuation">)</span><br>            <span class="token keyword">break</span><br>        <span class="token keyword">else</span><span class="token punctuation">:</span><br>            doms<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nextdom<span class="token punctuation">)</span><br>            domain <span class="token operator">=</span> nextdom<br>    <br>    <span class="token keyword">return</span> doms<br><br>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 測試的 domain 清單</span><br><span class="token keyword">for</span> d <span class="token keyword">in</span> l<span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span>zone_walk<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>前面在實際去爬 NSEC 之前，我們先判斷是否符合情境，否則就不用試了。要知道有沒有用 DNSSEC，我們可以看看有沒有 DNSKEY 紀錄，再來要知道是不是有用 NSEC3，可以看看有沒有 NSEC3PARAM 紀錄。當然不一定要用這兩個判斷，你也可以用 RRSIG，如果有 DNSSEC 就會得到回答，有 NSEC3 更是可以從簽署的 RRSet 看出來，像下面這樣。</p><pre class="language-txt"><code class="language-txt">bankchb.com.		7081	IN	RRSIG	NSEC3PARAM 8 2 7200 20220327154117 20220323151159 28470 bankchb.com. gSQghpTzVa7dZ1gD09K/fHq/BYluFaWRQco0z6xk+Cb/a3t6UzwyNKB1 XWgwUJ20cveJcLWhX3bGmw0MCjDCydxrjMc+jTuDj/pBe2BAV0UIoDGH oTz+B+HGyzqqnr6nSPUj13NYMEKIh/eNPcz5DZFlfTz0Z1gZkcxskJLD WNnZE83L/AVOnWGueHJMAVTsXPYexY58WqBfKwuAYLZZRO4UDLu21MYg uRfZK2LfZKHEJ8f1TWcT019XmEW2K3hJ/BO2nZ+jZsnFb3MZS19YT50P EmejkDpxbkLvLnYHRAqouoTvQUKC0x+4GhXMAFCGz5EoDBzriT23ftkb VEA2uA==<br>bankchb.com.		21481	IN	RRSIG	SOA 8 2 86400 20220328002618 20220323232618 28470 bankchb.com. eA0XM21R1Je+UELOeB2n0tBP4pnPwcQDsQy0T2cOYw3u1VGR5axF5s6/ uGQX2e0aqKwHFgY1sQ3dR0lrYKDOTQIX7FbYneM5hy7Ya+JahzdsonIp YlZ97bVjFUYpuC80RSiwIMcwLbDQZgm82lRZJ6nq1GQZks+Uzhp/73TD 0JXwioejoey3W+pTTs7c/gGlkSao9h0PGviBuoTuiKiM1FElLQ8E4VyC Nq0mbxqV3dtJPn0folZO4qYCDjIZB0tzhxFjotly0QSgPhxFau3BjBuo Ar/tSlAv5OPYav2nszYfGb3eR26Mvinh6YVrKIFUFYhr2i6swlaGWj9E xG5L6w==</code></pre><p>回到程式碼，在迴圈裡會判斷繞到頭了才結束，應該要把所有的網域都爬出來，存到陣列之後回傳。理論上，有用 DNSSEC 的話就要有 NSEC 紀錄，所以不應該撞到這個分支，但要是因為沒有使用 NSEC 或是其他設置原因還沒有紀錄，就把截至當下找到的紀錄們傳出來，方便我再進一步驗證。</p><h2 id="%5C000%EF%BC%9F%EF%BC%9F%EF%BC%9F"><a href="#%5C000%EF%BC%9F%EF%BC%9F%EF%BC%9F" class="direct-link">#</a> \000？？？</h2><p>對著大量的網域測試的時候，我卻很意外的發現大量的結果都是有 DNSSEC 卻沒有 NSEC 紀錄，而且清一色結果都是根網域的 NSEC 指向了一筆 <code>\000</code> 前綴的網域：</p><pre class="language-txt"><code class="language-txt">crypto.com<br>[*] No NSEC record found!<br>['crypto.com', '\\000.crypto.com']<br>kraken.com<br>[*] No NSEC record found!<br>['kraken.com', '\\000.kraken.com']<br>whitebit.com<br>[*] No NSEC record found!<br>['whitebit.com', '\\000.whitebit.com']</code></pre><p>這就奇怪了，怎麼連了一個就斷掉了呢？</p><p>為了解開這個謎題，我開始搜尋有哪些 RFC 提到這樣的實作。過去也有相當大的聲量在討論 zone walk 的問題，所以直覺上我認為說不定是某個與 NSEC3 並行的做法，雖然看不出是 proxy 還是什麼涵義。</p><p>過程中查到在 <a href="https://www.ietf.org/rfc/rfc4470.txt" rel="noopener noreferrer" target="_blank">RFC4470 Minimally Covering NSEC Records and DNSSEC On-line Signing</a> 中有這樣一段敘述：</p><blockquote><p>This mechanism involves changes to NSEC records for instantiated names, which can still be generated and signed in advance, as well as the on-demand generation and signing of new NSEC records whenever a name must be proven not to exist. ... Whenever an NSEC record is needed to prove the non-existence of a name, a new NSEC record is dynamically produced and signed. The new NSEC record has an owner name lexically before the QNAME but lexically following any existing name and a "next name" lexically following the QNAME but before any existing name.</p></blockquote><p>簡單來說，就是把本來區間的兩個端點往內縮一些，不要剛好標在『存在的網域上』，並且端點的選擇每次都會隨機，只要包圍的區間不涵蓋任何真正存在的網域就好。例如前面的情況，我們想詢問不存在的 <code>david.cymetrics.io</code>，這時就不會回 <code>crystal.cymetrics.com NSEC	huli.cymetrics.com</code> 而是動態產生另一筆 NSEC 紀錄，例如 <code>custard.cymetrics.com NSEC	garlic.cymetrics.com</code>。因為 custard 跟 garlic 也都是不存在的，不過 NSEC 標示的區間還是有效的，而且 NSEC 紀錄之間沒有連結了，駭客就無法做 zone walk。另外，NSEC 也要否決萬用字元（*, wildcard）的可能性，所以還要多回傳一筆 NSEC 紀錄是 <code>\).com NSEC +.com</code>。</p><p>但即使是如此，我們還是透露了『確定沒有網域』的區間，等同幫駭客用刪去法縮減了可能性，剛剛的例子中，我雖然不知道存在 crystal 跟 huli，但我至少知道 daky 跟 garfield 都是不存在的，省了需要猜的次數。所以為了盡可能不透露資訊，內縮的端點的選擇要盡可能貼近被詢問的網域，讓區間盡可能縮小，駭客要找到存在的網域的機率幾乎等同於亂猜直接猜中的機率。例如比起前面隨機選的，現在更好的選擇可能是 <code>daviczzzzz.cymetrics.com</code> 跟 <code>davieaaaaa.cymetrics.com</code>，這樣駭客就無法知道更多了。</p><p>甚至，他還提出了更好的選擇方式（RFC 內稱為 epsilon function），左端點把 query 最後一個字元換成前一個字母加上一串 <code>\255</code>，右端點在 query 加上前綴 <code>\000</code>，所以這一串下來：</p><pre class="language-txt"><code class="language-txt">query: david.cymetrics.com<br><br># original<br>crystal.cymetrics.com    	NSEC	huli.cymetrics.com<br><br># random choice<br>custard.cymetrics.com   NSEC	garlic.cymetrics.com<br><br># even better!<br>daviczzzzz.cymetrics.com    NSEC	davieaaaaa.cymetrics.com<br><br># proposed epsilon (with wildcard)<br>davie\255\255\255\255\255\255\255\255\255\255\255\255\255\255<br>     \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255<br>     \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255<br>     \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255<br>     \255.example.com 3600 IN NSEC \000.david.example.com<br><br>\)\255\255\255\255\255\255\255\255\255\255\255\255\255\255\255<br>     \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255<br>     \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255<br>     \255\255\255\255\255\255\255\255\255\255\255\255\255\255\255<br>     \255\255.example.com 3600 IN NSEC \000.*.example.com</code></pre><p>終於看到 <code>\000</code> 開頭的東西了！難道 RFC4470 就是我們的答案了嗎！本來是這樣想的，不過實際 dig 一下，好像又有些出入？</p><pre class="language-bash"><code class="language-bash"><span class="token function">dig</span> nsec <span class="token string">'*.whitebit.com'</span><br><br><span class="token comment"># expected</span><br><span class="token punctuation">\</span><span class="token punctuation">)</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><br>     <span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><br>     <span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><br>     <span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span><br>     <span class="token punctuation">\</span><span class="token number">255</span><span class="token punctuation">\</span><span class="token number">255</span>.whitebit.com.		<span class="token number">3600</span>	IN	NSEC	<span class="token punctuation">\</span>000.*.whitebit.com<br><br><span class="token comment"># actually</span><br>*.whitebit.com.		<span class="token number">3600</span>	IN	NSEC	<span class="token punctuation">\</span>000.*.whitebit.com</code></pre><p>回去看了一下大量測試的結果，注意到有 <code>\000</code> 前綴現象的，居然大多是用 Cloudflare 的服務，那看來這也許是跟 Cloudflare 特殊的實作方式有關！</p><p>再追一下，發現了這篇文章 <a href="https://blog.cloudflare.com/black-lies/" rel="noopener noreferrer" target="_blank">Economical With The Truth: Making DNSSEC Answers Cheap</a>，裡面提到 NSEC 本來設計上的缺陷，包含 zone walk 的問題、資源消耗過多（每一次詢問需要回傳兩筆 NSEC 紀錄，區間跟 wildcard），還有 RFC4470 沒有解決的困難，例如還是需要回兩筆紀錄、且推薦的 epsilon function 回傳的資料過長但不查詢 zone file 的情況下又難以選擇端點。以 Cloudflare 每天需要簽署 569 億筆紀錄的服務來說，效能是極為重要的，那就把 RFC4470 的概念再進化、執行的更淋漓盡致吧！</p><p>趣味知識：RFC4470 又被暱稱 White Lies（白色的謊言），因為是出於善意而『欺騙』resolver，故意回答不存在的、虛構的端點。Cloudflare 自稱他們的解法為 Black Lies（黑色的謊言），就是為了利益（Cloudflare 的效能）而說謊的意思！</p><p>在 Cloudflare 的做法中，只要是不存在的網域都會回傳 <code>\000</code> 前綴的答案，所以才會出現：</p><pre class="language-txt"><code class="language-txt">whitebit.com.	NSEC	\000.whitebit.com</code></pre><p>這樣做有幾個好處。第一，因為不是標記區間而是針對詢問的網域直接回答，所以不再需要回覆萬用字元的 NSEC 紀錄，也不需要多做一次線上簽署。</p><p>第二，整個紀錄大小小很多，省略了前面一卡車 <code>\255</code> 也不需要耗費 CPU 去隨機計算合適的端點。</p><p>第三，對於 Cloudflare 查詢資料庫來說更有效率，不過要更清楚地解釋這點，我們要先複習另一個 NSEC 紀錄的特點：NODATA。前一篇我們稍微提過，NSEC 記錄尾巴有一串紀錄類型的字串，代表了這個 NSEC 擁有者<strong>有</strong>的紀錄類型，所以假設你找 <code>crystal.cymetrics.com</code> 的 MX 紀錄但這個網域沒有，他可以回你 <code>crystal.cymetrics.com NSEC	huli.cymetrics.com A NS RRSIG NSEC</code> 來表達存在的只有 <code>A NS RRSIG NSEC</code> 這四種而已。這種回覆就叫做 NODATA。對 Cloudflare 來說，為了證明『其中一筆紀錄不存在』還要去搜資料庫找出『所有存在的紀錄』實在是太不划算了，所以為了可以不用查資料庫，Cloudflare 決定 NODATA 的回覆就在 NSEC 記錄後面加上所有的紀錄類型，唯獨除了請求的那種。如此一來，不僅不用查資料庫也不會多洩漏任何資訊，Cloudflare 稱之為 DNS shotgun。範例如下，會看到唯獨沒有 MX：</p><pre class="language-txt"><code class="language-txt">crystal.cymetrics.com    	NSEC	huli.cymetrics.com  A WKS HINFO TXT AAAA LOC SRV CERT SSHFP IPSECKEY RRSIG NSEC TLSA HIP OPENPGPKEY SPF</code></pre><p>Cloudflare 的做法並沒有違反現行的 RFC，所以不會有相容性的問題，而且這一套目前也已經被 Amazon Route53、NS1 等大型 DNS 供應商採用，看來未來可能會逐漸普遍，甚至 Cloudflare 也在推相應的 <a href="https://datatracker.ietf.org/doc/html/draft-valsorda-dnsop-black-lies" rel="noopener noreferrer" target="_blank">Internet Draft</a> 希望 Black Lies 未來能變成正式規範。雖然目前還沒有 RFC，不過 <a href="https://datatracker.ietf.org/meeting/111/materials/slides-111-dnsop-sessb-black-lies-ent-sentinel-01" rel="noopener noreferrer" target="_blank">IETF DNS Operations Working Group</a> 也有在會議中持續關注進展。</p><p>加入檢查 black / white lies 的完整版：</p><pre class="language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">zone_walk</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">:</span><br>    doms <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <span class="token comment"># zone 沒有用 DNSSEC 或 NSEC3, 不做 zone walk </span><br>    ans <span class="token operator">=</span> query_record<span class="token punctuation">(</span>domain<span class="token punctuation">,</span> <span class="token string">"DNSKEY"</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span><br>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Not using DNSSEC, no zone walk possible!'</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span> doms<br>    <br>    <span class="token comment"># zone 用 NSEC3, 不做 zone walk</span><br>    ans <span class="token operator">=</span> query_record<span class="token punctuation">(</span>domain<span class="token punctuation">,</span> <span class="token string">"NSEC3PARAM"</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span><br>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Using NSEC3, not vulnerable to zone walk! If you would like to traverse zone and crack hashes, use nsec3walker instead.'</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span> doms<br><br>    <span class="token comment"># 符合 black lies, 不做 zone walk</span><br>    ans <span class="token operator">=</span> query_record<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ireallydontexist'</span><span class="token punctuation">,</span>domain<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"NSEC"</span><span class="token punctuation">)</span><br>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> ans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"\\000"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><br>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Domain is using "Black lies" proposed by Cloudflare to block zone walking.'</span><span class="token punctuation">)</span><br>        <span class="token keyword">return</span> doms<br><br>    doms <span class="token operator">=</span> <span class="token punctuation">[</span>domain<span class="token punctuation">]</span><br>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span><br>        ans <span class="token operator">=</span> query_record<span class="token punctuation">(</span>domain<span class="token punctuation">,</span> <span class="token string">"NSEC"</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10.0</span><span class="token punctuation">)</span>    <span class="token comment"># setting this larger so walk doesn't break</span><br>        <span class="token comment"># zone walk 斷掉了？可能是網路 timeout 或是符合 white lies（NSEC 指向一個不存在的網域，所以下一個就找不到了）</span><br>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span><br>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] NSEC chain broken! There may be a connection issue, or the domain may be following RFC4470, dubbed "White Lies", to prevent zone walking.'</span><span class="token punctuation">)</span><br>            <span class="token keyword">break</span><br>        nextdom <span class="token operator">=</span> ans<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><br>        <span class="token keyword">if</span> nextdom <span class="token operator">==</span> doms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span><br>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Finished zone walk'</span><span class="token punctuation">)</span><br>            <span class="token keyword">break</span><br>        <span class="token keyword">else</span><span class="token punctuation">:</span><br>            doms<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nextdom<span class="token punctuation">)</span><br>            domain <span class="token operator">=</span> nextdom<br>    <br>    <span class="token keyword">return</span> doms<br><br>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment"># 測試的 domain 清單</span><br><span class="token keyword">for</span> d <span class="token keyword">in</span> l<span class="token punctuation">:</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><br>    <span class="token keyword">print</span><span class="token punctuation">(</span>zone_walk<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="%E7%B5%90%E8%AB%96"><a href="#%E7%B5%90%E8%AB%96" class="direct-link">#</a> 結論</h2><p>本來只是在測試的時候觀察到特別的現象，沒想到深入一看發現有各種抵抗 zone walk 的實作。除了用 NSEC3 之外，用 RFC4470 White Lies 或 Cloudflare 的 Black Lies 都是常見的選項，還有其他獨特的方法，例如看到 DNSimple 要特別指定 NSEC3 才會給你 NSEC 紀錄（？），或是一些開源自架的服務也會有自己的實作（畢竟就算是遵循 RFC4470 也還是留有很多彈性）。</p><p>前一篇有提過，已經有開源工具 <a href="https://linux.die.net/man/1/ldns-walk" rel="noopener noreferrer" target="_blank">ldns-walk</a> 或 <a href="https://dnscurve.org/nsec3walker.html" rel="noopener noreferrer" target="_blank">nsec3walker</a> 可以幫你做 zone walk，不過其實自己簡單寫一個也是很容易的，有興趣的話也可以試試自動化大範圍掃，畢竟流量其實不大不太會被擋 XDDD</p><p>附上一點點數據：</p><table><thead><tr><th>統計</th><th>百大台灣企業</th><th>百大數位貨幣交易所</th></tr></thead><tbody><tr><td>No DNSSEC</td><td>97</td><td>58</td></tr><tr><td>NSEC3</td><td>3</td><td>1</td></tr><tr><td>White Lies</td><td>0</td><td>3</td></tr><tr><td>Black Lies</td><td>0</td><td>38</td></tr></tbody></table><p>可見比起國外，台灣企業大多都沒有設置 DNSSEC，而使用 Black Lies 的數位貨幣交易所幾乎都是用 Cloudflare，市佔好高</p><div class="article-footer"><a href="https://tech-blog.cymetrics.io/posts/crystal/dns-hacking-zone-walk/" on-click="share"><img alt="Share" src="/img/icons/icon_external link hyperlink.svg" height="24" width="24">Share this post</a></div><div><p style="font-weight: bold;">Tag</p><div class="post-tags"><a href="/tags/security/" class="post-tag">#Security</a> <a href="/tags/dns/" class="post-tag">#DNS</a></div><p style="font-weight: bold;">Recommendation</p><ol><li><a href="/posts/genchilu/cache-strategy-zh/">來談談後端快取策略</a></li><li><a href="/posts/huli/crest-cpsa-prepare/">CPSA(CREST Practitioner Security Analyst) 資安分析師考試心得</a></li><li><a href="/posts/cymetrics/ecommerce-scam/">簡單三招學會辨識電商詐騙，讓你在雙11安心購物</a></li><li><a href="/posts/maxchiu/aop/">來談談 AOP (Aspect-Oriented Programming) 的精神與各種主流實現模式的差異</a></li><li><a href="/posts/jo/zerobased-cross-site-scripting/">零基礎資安系列（二）-認識 XSS（Cross-Site Scripting）</a></li></ol></div><div class="article-author"><img alt="crystal" src="/img/authors/crystal_logo.png" class="article-author__img" data-deopt="true"><div class="article-author__info"><div class="article-author__title">Author</div><div class="article-author__author"><a href="/posts/crystal">crystal</a></div><div class="article-author__intro">Security newbie with a gallon of passion</div></div></div><p style="font-weight: bold;">Discussion(login required)</p><script async="" src="https://utteranc.es/client.js" crossorigin="anonymous" id="utterance-script" issue-term="title" label="utterance" repo="cymetrics/blog" theme="github-light"></script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"DNS Hacking 小番外之：談談 zone walk","image":["https://tech-blog.cymetrics.io/img/icons/icon_external link hyperlink.svg","https://tech-blog.cymetrics.io/img/authors/crystal_logo.png"],"author":{"@type":"Person","name":"crystal"},"publisher":{"@type":"Organization","name":"Cymetrics Tech Blog","url":"https://tech-blog.cymetrics.io","logo":{"@type":"ImageObject","url":"https://tech-blog.cymetrics.io/img/favicon/favicon-512x512.png","width":512,"height":512}},"url":"https://tech-blog.cymetrics.io/posts/crystal/dns-hacking-zone-walk/","mainEntityOfPage":"https://tech-blog.cymetrics.io/posts/crystal/dns-hacking-zone-walk/","datePublished":"2022-03-25","dateModified":"2024-10-15","description":"如前一篇提過的，前陣子為了快速且大量掃描網域相關的問題，我寫了個自動化工具來找 zone transfer、zone walk、subdomain takeover 等問題，其中在測試 zone walk 的時候發現了關於業界防治 zone walk..."}</script></article></main><footer><div class="footer-logos"><a href="https://www.facebook.com/cymetrics" rel="noopener noreferrer" target="_blank"><img alt="facebook" src="/img/icons/icon_social media_facebook.svg" height="30" width="30"></a><a href="https://www.linkedin.com/company/cymetrics" rel="noopener noreferrer" target="_blank"><img alt="linkedin" src="/img/icons/icon_social media_linkedln.svg" height="30" width="30"></a><a href="https://tech-blog.cymetrics.io/feed/feed.xml" rel="noreferrer noopener" target="_blank"><img alt="rss feed" src="/img/icons/rss-feed.svg" height="30" width="30"></a></div><div class="copyright">© 2021 Cymetrics Tech Blog, based on <a href="https://github.com/google/eleventy-high-performance-blog" rel="noopener noreferrer" target="_blank">eleventy-high-performance-blog</a>. <a href="https://oneinfinity.global/" rel="noopener noreferrer" target="_blank">OneInfinity</a></div></footer><script>// light/dark theme switch
      // disable dark mode for now
      const menuBtn = document.querySelector('.menu__btn')
      menuBtn.addEventListener('click', function() {
        document.querySelector('body').classList.toggle('lock')
        menuBtn.classList.toggle('menu__btn--close');
        document.querySelector('.nav__links').classList.toggle('nav__links--open')
      })</script></body></html>