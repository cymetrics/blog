<!DOCTYPE html><html domain="tech-blog.cymetrics.io" ga-id="G-3VBVCXV9Z0" lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="CYBER,Cymetrics,Security" name="keywords"><link href="/img/favicon/favicon-192x192.png?hash=42b087227d" rel="icon" type="image/png"><meta content="#5789d3" name="theme-color"><title>Unveiling Access Control in Ethereum Smart Contracts: Common Access Control Vulnerabilities</title><meta content="Unveiling Access Control in Ethereum Smart Contracts: Common Access Control Vulnerabilities" property="og:title"><meta content="Unveiling Access Control in Ethereum Smart Contracts: Common Access Control Vulnerabilities" name="twitter:title"><meta content="summary_large_image" name="twitter:card"><meta content="# What is Access Control ?Access control refers to &amp;quot;who can perform a specific action,&amp;quot; which is crucial in the world of smart contracts. The access control of a contract can determine which roles can mint tokens, vote on proposals, freeze transfers, and execute many other essential functions. Properly implementing access control is vital to prevent unauthorized actors from performing actions.In OpenZeppelin, there are two primary ways to implement access control: Ownable and Role-Based Access Control (RBAC).Ownable grants control to the contract owner, making it suitable for simpler applications.When multiple roles or permission levels are involved, RBAC provides more granular control, enabling different roles to perform specific functions." name="description"><meta content="# What is Access Control ?Access control refers to &amp;quot;who can perform a specific action,&amp;quot; which is crucial in the world of smart contracts. The access control of a contract can determine which roles can mint tokens, vote on proposals, freeze transfers, and execute many other essential functions. Properly implementing access control is vital to prevent unauthorized actors from performing actions.In OpenZeppelin, there are two primary ways to implement access control: Ownable and Role-Based Access Control (RBAC).Ownable grants control to the contract owner, making it suitable for simpler applications.When multiple roles or permission levels are involved, RBAC provides more granular control, enabling different roles to perform specific functions." name="twitter:description"><meta content="# What is Access Control ?Access control refers to &amp;quot;who can perform a specific action,&amp;quot; which is crucial in the world of smart contracts. The access control of a contract can determine which roles can mint tokens, vote on proposals, freeze transfers, and execute many other essential functions. Properly implementing access control is vital to prevent unauthorized actors from performing actions.In OpenZeppelin, there are two primary ways to implement access control: Ownable and Role-Based Access Control (RBAC).Ownable grants control to the contract owner, making it suitable for simpler applications.When multiple roles or permission levels are involved, RBAC provides more granular control, enabling different roles to perform specific functions." property="og:description"><meta content="article" property="og:type"><meta content="https://tech-blog.cymetrics.io/en/posts/alice/solidity_access_control_en/" property="og:url"><meta content="Cymetrics Tech Blog" property="og:site_name"><meta content="https://tech-blog.cymetrics.io/img/favicon/favicon-512x512.png" property="og:image"><meta content="https://tech-blog.cymetrics.io/img/favicon/favicon-512x512.png" name="twitter:image"><meta content="hsZQwAip9iIbys-i4PJp_MfpNiA6w6RB0hYdWLiLUuk" name="google-site-verification"><link href="https://tech-blog.cymetrics.io/en/posts/alice/solidity_access_control_en/" rel="canonical"><meta content="always" name="referrer"><link href="/feed/feed.xml" rel="alternate" type="application/atom+xml" title="Cymetrics Tech Blog"><link href="/" rel="preconnect" crossorigin=""><script async="" src="/js/min.js?hash=7f26b2ece8" defer=""></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3VBVCXV9Z0"></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-3VBVCXV9Z0');</script><script csp-hash="">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>:root{--primary-color: #5789d3;--primary-dark-color: #ffd349;--fgColor: #2f2f2f;--bgColor: linear-gradient(to top, #efefef, #ffffff);--primary: var(--primary-color);--primary-dark: var(--primary-dark-color);--fg: var(--fgColor);--bg: var(--bgColor);--progressColor: #ffd349;--main-width: calc(100vw - 3em)}main img{content-visibility:auto}article *{scroll-margin-top:50px}header nav{z-index:1;position:fixed;top:0;left:0;width:100vw;background:#fff;font-weight:200;text-align:right;padding:0}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px;width:50px;height:50px;border-radius:50%;overflow:hidden;box-shadow:2px 3px 5px 2px rgba(0,0,0,.2)}@media screen and (max-width:376px){share-widget{display:none}}share-widget div{margin-left:50%;transform:translateX(-50%);width:20px;height:20px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center;background-size:contain}.apple share-widget div{background-image:url(/img/share-apple.svg)}share-widget button{margin:0;padding:0;width:100%;height:100%;transition:.3s}share-widget button:active{transform:scale(1.2)}dialog{background-color:var(--primary-dark);z-index:1000;font-size:14px}#reading-progress{z-index:1;background-color:var(--progressColor);width:100vw;position:absolute;left:0;bottom:0;height:2px;transform:translate(-100vw,0);will-change:transform;pointer-events:none}#posts li{margin-bottom:.5em}button,html{line-height:1.15}html{-webkit-text-size-adjust:100%;font-family:"Open Sans",-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans","Helvetica Neue",Helvetica,Arial,"Noto Sans TC","PingFang TC","Hiragino Sans GB","Heiti TC","Microsoft YaHei","Microsoft Jhenghei",sans-serif;--font-family: "Open Sans", -apple-system, system-ui, BlinkMacSystemFont,
    "Segoe UI", Roboto, "Noto Sans", "Helvetica Neue", Helvetica, Arial,
    "Noto Sans TC", "PingFang TC", "Hiragino Sans GB", "Heiti TC",
    "Microsoft YaHei", "Microsoft Jhenghei", sans-serif}body{margin:0}body.lock{overflow:hidden}a{background-color:transparent;text-underline-offset:2px;text-decoration:none;color:var(--primary)}b,strong{font-weight:700}img{border-style:none;max-width:100%;height:auto;margin:0 auto}button{font-family:inherit;font-size:100%;overflow:visible;text-transform:none}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}h2{font-size:2.5em;line-height:1.2;margin-bottom:.6em;line-height:2.4rem;margin-bottom:1.36rem;font-size:1.728rem}h3{font-size:2em;line-height:1.125;margin-bottom:.75em;font-size:1.4rem}h4{font-size:1.5em;margin-bottom:1em;line-height:1.5em}body,ol,p,pre{font-size:1em}ol,p,pre{margin-bottom:1.5em}h3,h4{line-height:1.5rem;margin-bottom:1rem}h4{font-size:1.2rem}body,ol,p,pre{font-size:1rem;line-height:1.6}ol,p,pre{margin-bottom:1.36rem}@media (min-width:600px){h2{font-size:2.0097rem;line-height:2.52rem}h3{font-size:1.7989rem;line-height:2rem}h4{font-size:1.3554rem;line-height:1.56rem;margin-bottom:1.296rem}body,ol,p,pre{font-size:1.1rem;line-height:1.6}h2,h3,ol,p,pre{margin-bottom:1.496rem}}@media (min-width:1200px){h2{font-size:2.05rem}h3{font-size:1.5rem}h4{font-size:1.15rem;line-height:1.42rem;margin-bottom:1.2rem}body,ol,p,pre{font-size:1.2rem;line-height:1.6}h2,h3,ol,p,pre{margin-bottom:1.632rem}}code,pre{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre code:not([class]){overflow-x:scroll}button,code{border-radius:.3em}code{color:#e33671;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%}h1,h2,h3,h4{font-family:var(--font-family)}a:hover{text-decoration:underline}button{max-width:100%;background:#f2f2f2;color:#191919;cursor:pointer;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}button+label,label+*{page-break-before:always}button,label{display:inline-block}button:hover{background:#d9d9d9;color:#000}button:not([disabled]){background:#f9c412;color:#181818;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--primary-dark)}*{border:0;box-sizing:border-box}body{font-family:var(--font-family);background:var(--bg);color:var(--fg)}header label{display:block}article,header{max-width:100%;width:42.5em;margin:0 auto}header{padding:4.5em 24px 0;text-align:center;display:flex;align-items:center;flex-direction:column}header p,ol{margin-top:0}header nav .nav-title{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav label{color:#000;cursor:pointer;margin:0;font-style:normal;text-align:right}main{max-width:70rem;margin:0 auto;min-height:60vh}article{padding:1.5em;word-break:break-word}li ol{margin-bottom:0}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.comment{color:#999}.token.punctuation{color:#ccc}.token.function,.token.number{color:#f08d49}.token.class-name,.token.property{color:#f8c555}.token.builtin,.token.keyword{color:#cc99cd}.token.string{color:#7ec699}.token.operator,.token.url{color:#67cdcc}.token.bold{font-weight:700}.token.inserted{color:green}::-webkit-scrollbar-thumb:hover{background:var(--primary)}.w-full{width:100%}h1{font-size:32px;line-height:1.25;margin:.67em 0;text-align:left}header aside{font-size:16px;color:#4b4b4b}.post,footer{border-top:1px solid #ccc}.post{padding-top:35px;margin-top:35px}.menu__btn{display:inline-block;width:24px;height:24px;position:relative}.menu__btn span{opacity:0;width:1px;height:1px;overflow:hidden;display:block}.menu__btn::after,.menu__btn::before{content:"";position:absolute;top:51%;left:50%;height:2px;width:17px;background-color:#2d2d2d;border-radius:.1rem}.menu__btn::before{transform:translate(-50%,-50%);box-shadow:0 .3rem 0 #2d2d2d,0 -.3rem 0 #2d2d2d}.menu__btn::after{display:none;transform:translate(-50%,-50%) rotate(90deg)}.menu__btn.menu__btn--close{z-index:9;transform:rotate(45deg)}.menu__btn.menu__btn--close::before{box-shadow:none}.menu__btn.menu__btn--close::after{display:block}#nav,#nav .nav-title{display:flex;align-items:center}#nav{position:relative;height:68px;z-index:2}#nav .nav-title{padding:.375rem 1.5rem;width:100%;justify-content:space-between}#nav .nav-title *,.article-footer img{margin:0}.nav__links{display:none;flex-direction:column;position:fixed;z-index:3;top:0;left:0;right:0;bottom:0;padding:86px 48px 0;background-image:linear-gradient(to top,#efefef,#fff),linear-gradient(to bottom,#f9f9f9,#f9f9f9)}.nav__links--open{display:flex}.nav__links a{text-align:left;width:100%;padding:.5rem 0;transition:all .3s ease-out;font-weight:700;text-decoration:none;color:var(--fg)}.nav__links a:hover{color:var(--primary-color)}.nav-logo{width:260px;height:40px;background:url(/img/logo1.png) no-repeat center center;background-size:contain}footer{margin-top:48px;font-size:14px;padding:24px;text-align:center}.copyright{display:inline-block}footer>*{margin:.5em}.footer-logos{display:flex;align-items:center;justify-content:center}.footer-logos a:not(:first-child){margin-left:32px}.post-tags{display:flex;gap:0 16px;flex-wrap:wrap}.direct-link{display:none}.post-avatar{margin-top:27px;display:flex;align-items:center;height:36px}.post-avatar__img{width:36px;height:36px;overflow:hidden;margin:0;border-radius:50%}.post-avatar__time{font-size:13px}.post-avatar__info{margin-left:8px;color:#747474;text-align:left}.post-avatar__author{font-size:14px;font-weight:700}.article-footer{margin-top:40px;border-bottom:1px solid #ccc;padding-bottom:52px}.article-footer a{float:right;display:flex;align-items:center;color:var(--fg);font-weight:700;margin-left:4px}.article-author{margin-top:34px;display:flex;align-items:flex-start;margin-bottom:48px}.article-author__img{width:80px;height:80px;overflow:hidden;margin:0;border-radius:50%;flex-shrink:0}.article-author__info{margin-left:16px;text-align:left}.article-author__title{color:#747474;font-size:16px}.article-author__author{font-size:22px;font-weight:700;line-height:1em}.article-author__intro{color:#2f2f2f;margin-top:8px}@media (min-width:768px){h1{font-size:48px}header aside{font-size:20px}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}.menu__btn{display:none}#nav,footer{max-width:1168px}#nav{height:80px;margin:0 auto}.nav-logo{width:313px}.nav__links{display:flex;flex-direction:row;position:static;padding:0;background-image:none}.nav__links a{text-align:center;margin-left:56px}footer{display:flex;flex-direction:row-reverse;justify-content:space-between;align-items:center;margin-left:auto;margin-right:auto}}</style></head><body><header><nav><div id="nav"><div class="nav-title"><a href="/en" class="nav-logo" title="Homepage"></a> <label class="menu__btn" for="menu__control"><span>Menu</span></label></div><div class="nav__links"><a href="/en/archive/">Archive</a> <a href="/en/tags/">Tags</a> <a href="/en/about/">About</a> <a href="/" style="white-space:nowrap;">中文</a></div></div><div id="reading-progress" aria-hidden="true"></div></nav><h1 class="w-full">Unveiling Access Control in Ethereum Smart Contracts: Common Access Control Vulnerabilities</h1><aside class="w-full"><div class="post-tags"><a href="/en/tags/postsen/" class="post-tag">#postsEn</a> <a href="/en/tags/blockchain/" class="post-tag">#Blockchain</a> <a href="/en/tags/solidity/" class="post-tag">#Solidity</a></div><div class="post-avatar"><img alt="AliceHsu" src="/img/authors/alice_logo.jpg" class="post-avatar__img" data-deopt="true"><div class="post-avatar__info"><div class="post-avatar__author"><a href="/en/posts/alice">AliceHsu</a></div><div class="post-avatar__time">19 Oct 2024</div></div></div></aside><dialog id="message"></dialog></header><main><article><div id="post-page"></div><p><picture><source sizes="(max-width: 758px) 100vw, 758px" srcset="/img/posts/alice/solidityAccessControl/access_control-1920w.webp 1920w, /img/posts/alice/solidityAccessControl/access_control-1280w.webp 1280w, /img/posts/alice/solidityAccessControl/access_control-840w.webp 840w, /img/posts/alice/solidityAccessControl/access_control-320w.webp 320w" type="image/webp"><source sizes="(max-width: 758px) 100vw, 758px" srcset="/img/posts/alice/solidityAccessControl/access_control-1920w.png 1920w, /img/posts/alice/solidityAccessControl/access_control-1280w.png 1280w, /img/posts/alice/solidityAccessControl/access_control-840w.png 840w, /img/posts/alice/solidityAccessControl/access_control-320w.png 320w" type="image/png"><img alt="" src="/img/posts/alice/solidityAccessControl/access_control-1920w.png" height="1080" width="1920" decoding="async" loading="lazy" style="background-size:cover;background-image:url(&#34;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 1920 1080'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' preserveAspectRatio='none' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA/klEQVQImQXB7ysDcQDA4e+fwJuVFzdrslPemIsyttLqaq3DOO0Ho6h1uTLlLG9s2pLrannjRMbeMFIsaWo1kcg7L8lbr/0PH88j1P5Z9ME5goEk4ZRDNHtE1GiRu/xD3fvAG/+mL9FEFCOnxGI2mdU66/Y9zuMXm9dPaJVj4vsv9CY7+GauENqkw3bpjYxzy0HjldbzL9WHH1LlNmPpJv7xC7zKCcKcbrCx7HJ2/s58vk7QcFH0Kum1T0KRDpJcw+MzETvhIgsTK+RNG9dqoxk1lrJ3KKM23ZJBj6dEl19DSLJOYmiRLT2HNXXIrnnDSMhiWC4gB3SkARVJVvkH0zWGOuwm1nAAAAAASUVORK5CYII='%3E%3C/image%3E%3C/svg%3E&#34;)"></picture></p><h2 id="what-is-access-control-%3F"><a href="#what-is-access-control-%3F" class="direct-link">#</a> What is Access Control ?</h2><p>Access control refers to "who can perform a specific action," which is crucial in the world of smart contracts. The access control of a contract can determine which roles can mint tokens, vote on proposals, freeze transfers, and execute many other essential functions. Properly implementing access control is vital to prevent unauthorized actors from performing actions.</p><p>In OpenZeppelin, there are two primary ways to implement access control: Ownable and Role-Based Access Control (RBAC).<br>Ownable grants control to the contract owner, making it suitable for simpler applications.<br>When multiple roles or permission levels are involved, RBAC provides more granular control, enabling different roles to perform specific functions.</p><h3 id="ownable"><a href="#ownable" class="direct-link">#</a> Ownable</h3><p>The <code>Ownable.sol</code> contract from OpenZeppelin provides a basic access control pattern, where the contract has a single <strong>owner</strong> who holds full control over the contract. This pattern typically restricts certain functions to be executed only by the contract owner. The <code>Ownable.sol</code> contract offers some fundamental functions, such as transferring ownership (<code>transferOwnership()</code>) and checking the current owner (<code>owner()</code>).</p><h3 id="role-based-access-control-(rbac)"><a href="#role-based-access-control-(rbac)" class="direct-link">#</a> Role-Based Access Control (RBAC)</h3><p>The <code>AccessControl.sol</code> contract from OpenZeppelin provides role-based access control. It allows the contract to assign different roles to various addresses, thereby controlling access to specific functions based on those roles. This pattern offers greater flexibility, enabling the assignment of different roles for different functions and providing more detailed control over the execution permissions within the contract.</p><p>This article will introduce some common vulnerabilities related to access control:</p><ol><li>Lack of a two-step process for contract ownership changes</li><li>Lack of access control</li></ol><h2 id="lack-of-two-step-process-for-contract-ownership-changes"><a href="#lack-of-two-step-process-for-contract-ownership-changes" class="direct-link">#</a> Lack of Two-Step Process for Contract Ownership Changes</h2><p>The contract does not use a phased process to complete ownership changes.</p><h3 id="example-of-vulnerability%3A-lack-of-two-step-process-for-contract-ownership-changes"><a href="#example-of-vulnerability%3A-lack-of-two-step-process-for-contract-ownership-changes" class="direct-link">#</a> Example of Vulnerability: Lack of Two-Step Process for Contract Ownership Changes</h3><p>The contract contains a function that allows changing the current address directly.</p><pre class="language-solidity"><code class="language-solidity"><span class="token comment">// SPDX-License-Identifier: MIT</span><br><span class="token keyword">pragma</span> <span class="token keyword">solidity</span> <span class="token operator">^</span><span class="token number version">0.8.0</span><span class="token punctuation">;</span><br><br><span class="token keyword">contract</span> <span class="token class-name">example</span> <span class="token punctuation">{</span><br>    <span class="token builtin">address</span> <span class="token keyword">public</span> currentAddress<span class="token punctuation">;</span><br><br>    <span class="token keyword">event</span> <span class="token function">AddressChanged</span><span class="token punctuation">(</span><span class="token builtin">address</span> <span class="token keyword">indexed</span> newAddress<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">modifier</span> <span class="token function">onlyCurrentAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> currentAddress<span class="token punctuation">,</span> <span class="token string">"Not authorized"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">_</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token builtin">address</span> initialAddress<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        currentAddress <span class="token operator">=</span> initialAddress<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br><br>    <span class="token keyword">function</span> <span class="token function">changeAddress</span><span class="token punctuation">(</span><span class="token builtin">address</span> _newAddress<span class="token punctuation">)</span> <span class="token keyword">public</span> onlyCurrentAddress <span class="token punctuation">{</span><br>        <span class="token keyword">require</span><span class="token punctuation">(</span>_newAddress <span class="token operator">!=</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Invalid address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        currentAddress <span class="token operator">=</span> _newAddress<span class="token punctuation">;</span><br>        <span class="token keyword">emit</span> <span class="token function">AddressChanged</span><span class="token punctuation">(</span>_newAddress<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br></code></pre><h3 id="details-of-the-vulnerability%3A-lack-of-two-step-process-for-contract-ownership-changes"><a href="#details-of-the-vulnerability%3A-lack-of-two-step-process-for-contract-ownership-changes" class="direct-link">#</a> Details of the Vulnerability: Lack of Two-Step Process for Contract Ownership Changes</h3><p>A single-step ownership change carries significant risks because any mistakes made during the process are irreversible. If an incorrect address is used when transferring ownership—such as an address with lost private keys, an incorrect address, or a non-whitelisted address—it can render all operations requiring owner privileges unusable.</p><p>Critical functions protected by <code>onlyOwner()</code> will become inaccessible since the correct ownership cannot be verified.</p><p>More similar findings:<br><a href="https://github.com/code-423n4/2021-11-bootfinance-findings/issues/35" rel="noopener noreferrer" target="_blank">1</a>, <a href="https://github.com/code-423n4/2021-07-pooltogether-findings/issues/40" rel="noopener noreferrer" target="_blank">2</a>, <a href="https://github.com/trailofbits/publications/blob/master/reviews/AdvancedBlockchainQ12022.pdf" rel="noopener noreferrer" target="_blank">3</a>, <a href="https://github.com/trailofbits/publications/blob/master/reviews/MorphoLabs.pdf" rel="noopener noreferrer" target="_blank">4</a>, <a href="https://github.com/trailofbits/publications/blob/master/reviews/LooksRare.pdf" rel="noopener noreferrer" target="_blank">5</a></p><h2 id="lack-of-access-control"><a href="#lack-of-access-control" class="direct-link">#</a> Lack of Access Control</h2><p>Critical functions or parameters in the contract lack proper access control, allowing unauthorized users to manipulate or modify them, leading to potential security risks.</p><h3 id="example-of-vulnerability%3A-lack-of-access-control"><a href="#example-of-vulnerability%3A-lack-of-access-control" class="direct-link">#</a> Example of Vulnerability: Lack of Access Control</h3><p>The contract contains a function that allows modifying the owner and performing withdrawals.</p><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">pragma</span> <span class="token keyword">solidity</span> <span class="token operator">^</span><span class="token number version">0.8.0</span><span class="token punctuation">;</span><br><br><span class="token keyword">contract</span> <span class="token class-name">example</span> <span class="token punctuation">{</span><br>    <span class="token builtin">address</span> <span class="token keyword">public</span> owner<span class="token punctuation">;</span><br>    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        owner <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">function</span> <span class="token function">setOwner</span><span class="token punctuation">(</span><span class="token builtin">address</span> _newOwner<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span><br>        owner <span class="token operator">=</span> _newOwner<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    <span class="token function">receive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">payable</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br>   <span class="token keyword">function</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span><br>        <span class="token keyword">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> owner<span class="token punctuation">,</span> <span class="token string">"Not authorized"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">(</span><span class="token builtin">bool</span> success<span class="token punctuation">,</span> <span class="token punctuation">)</span> <span class="token operator">=</span> owner<span class="token punctuation">.</span>call<span class="token punctuation">{</span>value<span class="token punctuation">:</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span>balance<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">require</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> <span class="token string">"Transfer failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br></code></pre><h3 id="details-of-the-vulnerability%3A-lack-of-access-control"><a href="#details-of-the-vulnerability%3A-lack-of-access-control" class="direct-link">#</a> Details of the Vulnerability: Lack of Access Control</h3><p>The <code>setOwner()</code> function lacks proper access control, allowing anyone to invoke it and change the contract’s owner. An attacker can use <code>setOwner()</code> to set their own address as the contract owner, bypassing the ownership check in the <code>withdraw()</code> function:</p><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> owner<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>This allows the attacker to call <code>withdraw()</code> and drain all the funds from the contract.</p><h3 id="security-incidents-related-to-lack-of-access-control"><a href="#security-incidents-related-to-lack-of-access-control" class="direct-link">#</a> Security Incidents Related to Lack of Access Control</h3><h4 id="2024-04-ngf"><a href="#2024-04-ngf" class="direct-link">#</a> 2024-04-NGF</h4><p>Due to the lack of proper access control in the contract, the attacker exploited the <a href="https://bscscan.com/address/0xa608985f5b40cdf6862bec775207f84280a91e3a#code#F1#L485" rel="noopener noreferrer" target="_blank">delegateCallReserves()</a> and <a href="https://bscscan.com/address/0xa608985f5b40cdf6862bec775207f84280a91e3a#code#F1#L521" rel="noopener noreferrer" target="_blank">reserveMultiSync()</a> functions to modify the reserve logic and transfer NGFS tokens from the liquidity pool to their own address. The attacker then swapped the NGFS tokens for USDT on PancakeSwap, resulting in a loss of approximately $190,000.</p><p><a href="https://github.com/SunWeb3Sec/DeFiHackLabs?tab=readme-ov-file#20240425-ngfs---bad-access-control" rel="noopener noreferrer" target="_blank">NGF Hacks Reproduce</a></p><h4 id="2022-09-ragnarok-online-invasion"><a href="#2022-09-ragnarok-online-invasion" class="direct-link">#</a> 2022-09-Ragnarok Online Invasion</h4><p>The vulnerable <a href="https://bscscan.com/address/0xe48b75dc1b131fd3a8364b0580f76efd04cf6e9c#code#L185" rel="noopener noreferrer" target="_blank">code snippet</a>:</p><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">function</span> <span class="token function">transferOwnership</span><span class="token punctuation">(</span><span class="token builtin">address</span> newOwner<span class="token punctuation">)</span> <span class="token keyword">public</span> virtual <span class="token punctuation">{</span><br>        <span class="token keyword">require</span><span class="token punctuation">(</span>newOwner <span class="token operator">!=</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Ownable: new owner is the zero address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">emit</span> <span class="token function">OwnershipTransferred</span><span class="token punctuation">(</span>_owner<span class="token punctuation">,</span> newOwner<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        _owner <span class="token operator">=</span> newOwner<span class="token punctuation">;</span><br>    <span class="token punctuation">}</span></code></pre><p>The attacker used the <code>transferOwnership()</code> function to transfer ownership to themselves and modified fee-related parameters such as <code>setTaxFeePercent()</code> to avoid paying transaction fees.</p><p>Additionally, the attacker excluded certain accounts from receiving dividends, disrupting the token distribution mechanism.</p><p>Finally, the attacker exploited the high fee mechanism through flash loan transactions, causing an imbalance in the liquidity pool and converting the tokens into BNB for profit.</p><h2 id="how-to-implement-proper-access-control"><a href="#how-to-implement-proper-access-control" class="direct-link">#</a> How to Implement Proper Access Control</h2><p>When designing smart contracts, apply the <strong>Principle of Least Privilege (POLP)</strong>, ensuring that each role and function is granted only the minimum permissions required to perform necessary operations. This approach significantly reduces the control that centralized or privileged roles have over critical functions.</p><p>To further mitigate the risk of manipulation by attackers, consider adding <strong>time locks</strong> or implementing <strong>corresponding processes</strong> for changing key function values. This makes unauthorized manipulation more difficult.</p><div class="article-footer"><a href="https://tech-blog.cymetrics.io/en/posts/alice/solidity_access_control_en/" on-click="share"><img alt="Share" src="/img/icons/icon_external link hyperlink.svg" height="24" width="24">Share this post</a></div><div><p style="font-weight: bold;">Tag</p><div class="post-tags"><a href="/en/tags/postsen/" class="post-tag">#postsEn</a> <a href="/en/tags/blockchain/" class="post-tag">#Blockchain</a> <a href="/en/tags/solidity/" class="post-tag">#Solidity</a></div><p style="font-weight: bold;">Recommendation</p><ol><li><a href="/en/posts/zet/purple-man-my-superman/">Walking around between Red Team and Blue Team - Purple Man, My Superman</a></li><li><a href="/en/posts/nick/exchange_en/">How to Choose a Safe Exchange</a></li><li><a href="/en/posts/cymetrics/critical-java-0day-spring4shell/">Spring4shell - a new critical RCE vulnerability found in Java Spring Framework</a></li><li><a href="/en/posts/huli/log4j-and-log4shell/">Understanding Log4j and Log4Shell Vulnerabilities from Surveillance Cameras</a></li><li><a href="/en/posts/genchilu/concurrency-paradigms-golang-and-java-en/">Concurrency Paradigms: Golang V.S. Java</a></li></ol></div><div class="article-author"><img alt="AliceHsu" src="/img/authors/alice_logo.jpg" class="article-author__img" data-deopt="true"><div class="article-author__info"><div class="article-author__title">Author</div><div class="article-author__author"><a href="/en/posts/alice">AliceHsu</a></div><div class="article-author__intro">OP and white hat @DeFiHackLabs</div></div></div><p style="font-weight: bold;">Discussion(login required)</p><script async="" src="https://utteranc.es/client.js" crossorigin="anonymous" id="utterance-script" issue-term="title" label="utterance" repo="cymetrics/blog" theme="github-light"></script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Unveiling Access Control in Ethereum Smart Contracts: Common Access Control Vulnerabilities","image":["https://tech-blog.cymetrics.io/img/posts/alice/solidityAccessControl/access_control-1920w.png","https://tech-blog.cymetrics.io/img/icons/icon_external link hyperlink.svg","https://tech-blog.cymetrics.io/img/authors/alice_logo.jpg"],"author":{"@type":"Person","name":"AliceHsu"},"publisher":{"@type":"Organization","name":"Cymetrics Tech Blog","url":"https://tech-blog.cymetrics.io","logo":{"@type":"ImageObject","url":"https://tech-blog.cymetrics.io/img/favicon/favicon-512x512.png","width":512,"height":512}},"url":"https://tech-blog.cymetrics.io/en/posts/alice/solidity_access_control_en/","mainEntityOfPage":"https://tech-blog.cymetrics.io/en/posts/alice/solidity_access_control_en/","datePublished":"2024-10-19","dateModified":"2024-10-15","description":"# What is Access Control ? Access control refers to &amp;quot;who can perform a specific action,&amp;quot; which is crucial in the world of smart..."}</script></article></main><footer><div class="footer-logos"><a href="https://www.facebook.com/cymetrics" rel="noopener noreferrer" target="_blank"><img alt="facebook" src="/img/icons/icon_social media_facebook.svg" height="30" width="30"></a><a href="https://www.linkedin.com/company/cymetrics" rel="noopener noreferrer" target="_blank"><img alt="linkedin" src="/img/icons/icon_social media_linkedln.svg" height="30" width="30"></a><a href="https://tech-blog.cymetrics.io/feed/feed.xml" rel="noreferrer noopener" target="_blank"><img alt="rss feed" src="/img/icons/rss-feed.svg" height="30" width="30"></a></div><div class="copyright">© 2021 Cymetrics Tech Blog, based on <a href="https://github.com/google/eleventy-high-performance-blog" rel="noopener noreferrer" target="_blank">eleventy-high-performance-blog</a>. <a href="https://oneinfinity.global/" rel="noopener noreferrer" target="_blank">OneInfinity</a></div></footer><script>const menuBtn = document.querySelector('.menu__btn')
      menuBtn.addEventListener('click', function() {
        document.querySelector('body').classList.toggle('lock')
        menuBtn.classList.toggle('menu__btn--close');
        document.querySelector('.nav__links').classList.toggle('nav__links--open')
      })</script></body></html>