<!DOCTYPE html><html domain="tech-blog.cymetrics.io" ga-id="G-3VBVCXV9Z0" lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><meta content="CYBER,Cymetrics,Security" name="keywords"><link href="/img/favicon/favicon-192x192.png?hash=42b087227d" rel="icon" type="image/png"><meta content="#5789d3" name="theme-color"><title>Decoding DoS Attacks in Solidity: Security Vulnerabilities and Prevention Strategies.</title><meta content="Decoding DoS Attacks in Solidity: Security Vulnerabilities and Prevention Strategies." property="og:title"><meta content="Decoding DoS Attacks in Solidity: Security Vulnerabilities and Prevention Strategies." name="twitter:title"><meta content="summary_large_image" name="twitter:card"><meta content="# What is Denial of Service ?In Solidity, Denial of Service (DoS) is a common vulnerability type that disrupts the expected execution of contract functions by exhausting resources or blocking the contract’s operation. In the blockchain world, code represents the flow of funds or the execution of internal logic. In severe cases, DoS can directly result in asset or fund immobilization, leading to losses for users or protocols.This article will introduce several common DoS scenarios:Unbounded loopIntegration/Logical errorRefund failed" name="description"><meta content="# What is Denial of Service ?In Solidity, Denial of Service (DoS) is a common vulnerability type that disrupts the expected execution of contract functions by exhausting resources or blocking the contract’s operation. In the blockchain world, code represents the flow of funds or the execution of internal logic. In severe cases, DoS can directly result in asset or fund immobilization, leading to losses for users or protocols.This article will introduce several common DoS scenarios:Unbounded loopIntegration/Logical errorRefund failed" name="twitter:description"><meta content="# What is Denial of Service ?In Solidity, Denial of Service (DoS) is a common vulnerability type that disrupts the expected execution of contract functions by exhausting resources or blocking the contract’s operation. In the blockchain world, code represents the flow of funds or the execution of internal logic. In severe cases, DoS can directly result in asset or fund immobilization, leading to losses for users or protocols.This article will introduce several common DoS scenarios:Unbounded loopIntegration/Logical errorRefund failed" property="og:description"><meta content="article" property="og:type"><meta content="https://tech-blog.cymetrics.io/en/posts/alice/solidiyDoS_en/" property="og:url"><meta content="Cymetrics Tech Blog" property="og:site_name"><meta content="https://tech-blog.cymetrics.io/img/favicon/favicon-512x512.png" property="og:image"><meta content="https://tech-blog.cymetrics.io/img/favicon/favicon-512x512.png" name="twitter:image"><meta content="hsZQwAip9iIbys-i4PJp_MfpNiA6w6RB0hYdWLiLUuk" name="google-site-verification"><link href="https://tech-blog.cymetrics.io/en/posts/alice/solidiyDoS_en/" rel="canonical"><meta content="always" name="referrer"><link href="/feed/feed.xml" rel="alternate" type="application/atom+xml" title="Cymetrics Tech Blog"><link href="/" rel="preconnect" crossorigin=""><script async="" src="/js/min.js?hash=7f26b2ece8" defer=""></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3VBVCXV9Z0"></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-3VBVCXV9Z0');</script><script csp-hash="">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>:root{--primary-color: #5789d3;--primary-dark-color: #ffd349;--fgColor: #2f2f2f;--bgColor: linear-gradient(to top, #efefef, #ffffff);--primary: var(--primary-color);--primary-dark: var(--primary-dark-color);--fg: var(--fgColor);--bg: var(--bgColor);--progressColor: #ffd349;--main-width: calc(100vw - 3em)}main img{content-visibility:auto}article *{scroll-margin-top:50px}header nav{z-index:1;position:fixed;top:0;left:0;width:100vw;background:#fff;font-weight:200;text-align:right;padding:0}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px;width:50px;height:50px;border-radius:50%;overflow:hidden;box-shadow:2px 3px 5px 2px rgba(0,0,0,.2)}@media screen and (max-width:376px){share-widget{display:none}}share-widget div{margin-left:50%;transform:translateX(-50%);width:20px;height:20px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center;background-size:contain}.apple share-widget div{background-image:url(/img/share-apple.svg)}share-widget button{margin:0;padding:0;width:100%;height:100%;transition:.3s}share-widget button:active{transform:scale(1.2)}dialog{background-color:var(--primary-dark);z-index:1000;font-size:14px}#reading-progress{z-index:1;background-color:var(--progressColor);width:100vw;position:absolute;left:0;bottom:0;height:2px;transform:translate(-100vw,0);will-change:transform;pointer-events:none}#posts li{margin-bottom:.5em}button,html{line-height:1.15}html{-webkit-text-size-adjust:100%;font-family:"Open Sans",-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans","Helvetica Neue",Helvetica,Arial,"Noto Sans TC","PingFang TC","Hiragino Sans GB","Heiti TC","Microsoft YaHei","Microsoft Jhenghei",sans-serif;--font-family: "Open Sans", -apple-system, system-ui, BlinkMacSystemFont,
    "Segoe UI", Roboto, "Noto Sans", "Helvetica Neue", Helvetica, Arial,
    "Noto Sans TC", "PingFang TC", "Hiragino Sans GB", "Heiti TC",
    "Microsoft YaHei", "Microsoft Jhenghei", sans-serif}body{margin:0}body.lock{overflow:hidden}a{background-color:transparent;text-underline-offset:2px;text-decoration:none;color:var(--primary)}b,strong{font-weight:700}small{font-size:80%;color:#ccc}img{border-style:none;max-width:100%;height:auto;margin:0 auto}button{font-family:inherit;font-size:100%;overflow:visible;text-transform:none}[type=button],[type=reset],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}h2{font-size:2.5em;line-height:1.2;margin-bottom:.6em;line-height:2.4rem;margin-bottom:1.36rem;font-size:1.728rem}h3{font-size:2em;line-height:1.125;margin-bottom:.75em;font-size:1.4rem;line-height:1.5rem;margin-bottom:1rem}body,ol,p,pre{font-size:1em}ol,p,pre{margin-bottom:1.5em}body,ol,p,pre{font-size:1rem;line-height:1.6}ol,p,pre{margin-bottom:1.36rem}@media (min-width:600px){h2{font-size:2.0097rem;line-height:2.52rem}h3{font-size:1.7989rem;line-height:2rem}body,ol,p,pre{font-size:1.1rem;line-height:1.6}h2,h3,ol,p,pre{margin-bottom:1.496rem}}@media (min-width:1200px){h2{font-size:2.05rem}h3{font-size:1.5rem}body,ol,p,pre{font-size:1.2rem;line-height:1.6}h2,h3,ol,p,pre{margin-bottom:1.632rem}}code,pre{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre code:not([class]){overflow-x:scroll}button,code{border-radius:.3em}code{color:#e33671;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%}h1,h2,h3{font-family:var(--font-family)}a:hover{text-decoration:underline}button{max-width:100%;background:#f2f2f2;color:#191919;cursor:pointer;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}button+label,label+*{page-break-before:always}button,label{display:inline-block}button:hover{background:#d9d9d9;color:#000}button:not([disabled]){background:#f9c412;color:#181818;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--primary-dark)}*{border:0;box-sizing:border-box}body{font-family:var(--font-family);background:var(--bg);color:var(--fg)}header label{display:block}article,header{max-width:100%;width:42.5em;margin:0 auto}header{padding:4.5em 24px 0;text-align:center;display:flex;align-items:center;flex-direction:column}header p,ol{margin-top:0}header nav .nav-title{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav label{color:#000;cursor:pointer;margin:0;font-style:normal;text-align:right}main{max-width:70rem;margin:0 auto;min-height:60vh}article{padding:1.5em;word-break:break-word}li ol{margin-bottom:0}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.comment{color:#999}.token.punctuation{color:#ccc}.token.function,.token.number{color:#f08d49}.token.class-name,.token.property{color:#f8c555}.token.builtin,.token.keyword{color:#cc99cd}.token.string{color:#7ec699}.token.operator,.token.url{color:#67cdcc}.token.bold{font-weight:700}.token.inserted{color:green}::-webkit-scrollbar-thumb:hover{background:var(--primary)}.w-full{width:100%}h1{font-size:32px;line-height:1.25;margin:.67em 0;text-align:left}header aside{font-size:16px;color:#4b4b4b}.post,footer{border-top:1px solid #ccc}.post{padding-top:35px;margin-top:35px}.menu__btn{display:inline-block;width:24px;height:24px;position:relative}.menu__btn span{opacity:0;width:1px;height:1px;overflow:hidden;display:block}.menu__btn::after,.menu__btn::before{content:"";position:absolute;top:51%;left:50%;height:2px;width:17px;background-color:#2d2d2d;border-radius:.1rem}.menu__btn::before{transform:translate(-50%,-50%);box-shadow:0 .3rem 0 #2d2d2d,0 -.3rem 0 #2d2d2d}.menu__btn::after{display:none;transform:translate(-50%,-50%) rotate(90deg)}.menu__btn.menu__btn--close{z-index:9;transform:rotate(45deg)}.menu__btn.menu__btn--close::before{box-shadow:none}.menu__btn.menu__btn--close::after{display:block}#nav,#nav .nav-title{display:flex;align-items:center}#nav{position:relative;height:68px;z-index:2}#nav .nav-title{padding:.375rem 1.5rem;width:100%;justify-content:space-between}#nav .nav-title *,.article-footer img{margin:0}.nav__links{display:none;flex-direction:column;position:fixed;z-index:3;top:0;left:0;right:0;bottom:0;padding:86px 48px 0;background-image:linear-gradient(to top,#efefef,#fff),linear-gradient(to bottom,#f9f9f9,#f9f9f9)}.nav__links--open{display:flex}.nav__links a{text-align:left;width:100%;padding:.5rem 0;transition:all .3s ease-out;font-weight:700;text-decoration:none;color:var(--fg)}.nav__links a:hover{color:var(--primary-color)}.nav-logo{width:260px;height:40px;background:url(/img/logo1.png) no-repeat center center;background-size:contain}footer{margin-top:48px;font-size:14px;padding:24px;text-align:center}.copyright{display:inline-block}footer>*{margin:.5em}.footer-logos{display:flex;align-items:center;justify-content:center}.footer-logos a:not(:first-child){margin-left:32px}.post-tags{display:flex;gap:0 16px;flex-wrap:wrap}.direct-link{display:none}.post-avatar{margin-top:27px;display:flex;align-items:center;height:36px}.post-avatar__img{width:36px;height:36px;overflow:hidden;margin:0;border-radius:50%}.post-avatar__time{font-size:13px}.post-avatar__info{margin-left:8px;color:#747474;text-align:left}.post-avatar__author{font-size:14px;font-weight:700}.article-footer{margin-top:40px;border-bottom:1px solid #ccc;padding-bottom:52px}.article-footer a{float:right;display:flex;align-items:center;color:var(--fg);font-weight:700;margin-left:4px}.article-author{margin-top:34px;display:flex;align-items:flex-start;margin-bottom:48px}.article-author__img{width:80px;height:80px;overflow:hidden;margin:0;border-radius:50%;flex-shrink:0}.article-author__info{margin-left:16px;text-align:left}.article-author__title{color:#747474;font-size:16px}.article-author__author{font-size:22px;font-weight:700;line-height:1em}.article-author__intro{color:#2f2f2f;margin-top:8px}@media (min-width:768px){h1{font-size:48px}header aside{font-size:20px}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}.menu__btn{display:none}#nav,footer{max-width:1168px}#nav{height:80px;margin:0 auto}.nav-logo{width:313px}.nav__links{display:flex;flex-direction:row;position:static;padding:0;background-image:none}.nav__links a{text-align:center;margin-left:56px}footer{display:flex;flex-direction:row-reverse;justify-content:space-between;align-items:center;margin-left:auto;margin-right:auto}}</style></head><body><header><nav><div id="nav"><div class="nav-title"><a href="/en" class="nav-logo" title="Homepage"></a> <label class="menu__btn" for="menu__control"><span>Menu</span></label></div><div class="nav__links"><a href="/en/archive/">Archive</a> <a href="/en/tags/">Tags</a> <a href="/en/about/">About</a> <a href="/" style="white-space:nowrap;">中文</a></div></div><div id="reading-progress" aria-hidden="true"></div></nav><h1 class="w-full">Decoding DoS Attacks in Solidity: Security Vulnerabilities and Prevention Strategies.</h1><aside class="w-full"><div class="post-tags"><a href="/en/tags/postsen/" class="post-tag">#postsEn</a> <a href="/en/tags/blockchain/" class="post-tag">#Blockchain</a> <a href="/en/tags/solidity/" class="post-tag">#Solidity</a></div><div class="post-avatar"><img alt="AliceHsu" src="/img/authors/alice_logo.jpg" class="post-avatar__img" data-deopt="true"><div class="post-avatar__info"><div class="post-avatar__author"><a href="/en/posts/alice">AliceHsu</a></div><div class="post-avatar__time">17 Oct 2024</div></div></div></aside><dialog id="message"></dialog></header><main><article><div id="post-page"></div><p><picture><source sizes="(max-width: 758px) 100vw, 758px" srcset="/img/posts/alice/solidityDoS/solidityDos-1920w.webp 1920w, /img/posts/alice/solidityDoS/solidityDos-1280w.webp 1280w, /img/posts/alice/solidityDoS/solidityDos-840w.webp 840w, /img/posts/alice/solidityDoS/solidityDos-320w.webp 320w" type="image/webp"><source sizes="(max-width: 758px) 100vw, 758px" srcset="/img/posts/alice/solidityDoS/solidityDos-1920w.png 1920w, /img/posts/alice/solidityDoS/solidityDos-1280w.png 1280w, /img/posts/alice/solidityDoS/solidityDos-840w.png 840w, /img/posts/alice/solidityDoS/solidityDos-320w.png 320w" type="image/png"><img alt="" src="/img/posts/alice/solidityDoS/solidityDos-1920w.png" height="1080" width="1920" decoding="async" loading="lazy" style="background-size:cover;background-image:url(&#34;data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http%3A//www.w3.org/2000/svg' xmlns%3Axlink='http%3A//www.w3.org/1999/xlink' viewBox='0 0 1920 1080'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='.5'%3E%3C/feGaussianBlur%3E%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'%3E%3C/feFuncA%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Cimage filter='url(%23b)' preserveAspectRatio='none' height='100%25' width='100%25' xlink%3Ahref='data%3Aimage/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA4klEQVQImQXBS07CUABA0QfWgqWVh9R+CIXX0hb5tCWk0agYCRoZqFEnOHLgDowjjQxdiHEbLu56jribxrx9/LLd/vB5VfJ9ecLYjpBGxMibMvZzYidD6MLgbH7P69cfR9E5p8GAwo9QrRB1kJK6OYk7Q5j6PhfdgNDLeH54YbN65Hq2JPdCklaHoNkjaCrEUEqKQxdltSlGczaLG56OV0SyS7tuY2kmtYqOWHgWqt3hfb1kFaaUQUqpMnyrj7lro1VNqhUDIfU9tJ06t6Mhi8GMxJvQcyY4MsVuxDiNPrLm8Q+S4FgCOnDHJwAAAABJRU5ErkJggg=='%3E%3C/image%3E%3C/svg%3E&#34;)"></picture></p><h2 id="what-is-denial-of-service-%3F"><a href="#what-is-denial-of-service-%3F" class="direct-link">#</a> What is Denial of Service ?</h2><p>In Solidity, Denial of Service (DoS) is a common vulnerability type that disrupts the expected execution of contract functions by exhausting resources or blocking the contract’s operation. In the blockchain world, code represents the flow of funds or the execution of internal logic. In severe cases, DoS can directly result in asset or fund immobilization, leading to losses for users or protocols.</p><p>This article will introduce several common DoS scenarios:</p><ol><li>Unbounded loop</li><li>Integration/Logical error</li><li>Refund failed</li></ol><h2 id="unbounded-loop"><a href="#unbounded-loop" class="direct-link">#</a> Unbounded loop</h2><p>This means that a loop without a clear termination condition could cause the loop to run continuously. In Solidity, each operation consumes Gas, which could directly result in transaction failure.</p><h3 id="unbounded-loop-%E6%BC%8F%E6%B4%9E%E7%AF%84%E4%BE%8B"><a href="#unbounded-loop-%E6%BC%8F%E6%B4%9E%E7%AF%84%E4%BE%8B" class="direct-link">#</a> Unbounded loop 漏洞範例</h3><p>The contract contains a function used to withdraw funds from the deposit array.</p><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">struct</span> <span class="token class-name">Deposit</span> <span class="token punctuation">{</span><br>  <span class="token builtin">address</span> depositor<span class="token punctuation">;</span><br>  <span class="token builtin">uint256</span> amount<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br>Deposit<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">public</span> deposits<span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">deposit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">payable</span> <span class="token punctuation">{</span><br>  deposits<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">Deposit</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span> msg<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span><br>  <span class="token builtin">uint256</span> totalAmount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br>  <span class="token builtin">uint256</span> length <span class="token operator">=</span> deposits<span class="token punctuation">.</span>length<span class="token punctuation">;</span><br><br>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token builtin">uint256</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>deposits<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>depositor <span class="token operator">==</span> msg<span class="token punctuation">.</span>sender <span class="token operator">&&</span> deposits<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>amount <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token builtin">uint256</span> amountToTransfer <span class="token operator">=</span> deposits<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>amount<span class="token punctuation">;</span><br>      deposits<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>amount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><br><br>      <span class="token punctuation">(</span><span class="token builtin">bool</span> success<span class="token punctuation">,</span> <span class="token punctuation">)</span> <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">.</span>call <span class="token punctuation">{</span><br>        value<span class="token punctuation">:</span> amountToTransfer<br>      <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">require</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> <span class="token string">"Transfer failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h3 id="background-knowledge-of-unbounded-loop-vulnerability-example"><a href="#background-knowledge-of-unbounded-loop-vulnerability-example" class="direct-link">#</a> Background knowledge of Unbounded loop Vulnerability Example</h3><p><strong>What is Gas?</strong></p><p>A unit used to measure the amount of computation required to execute an operation. In blockchain, every transaction operation, from simple transfers to complex contract interactions, requires gas.</p><p><strong>Gas Limit</strong></p><p>It is a mechanism that helps prevent infinite loops and other unintended computations from consuming all network resources by setting a maximum limit on the amount of gas that can be used by a smart contract. When the amount of gas used by the contract exceeds the gas limit, the contract will stop executing, and any changes will be reverted.</p><h3 id="details-of-the-unbounded-loop-vulnerability-example"><a href="#details-of-the-unbounded-loop-vulnerability-example" class="direct-link">#</a> Details of the Unbounded Loop Vulnerability Example</h3><p>If the length of the deposits array is too long, the transaction may fail due to excessive Gas consumption, causing the withdrawal operation to fail. As the number of users increases, the length of the deposits array will continue to grow, leading to higher Gas fees for regular users when attempting to withdraw. This could eventually result in transaction failures or even the inability to withdraw the funds they have deposited.</p><h2 id="integration%2Flogical-error"><a href="#integration%2Flogical-error" class="direct-link">#</a> Integration/Logical error</h2><p>This often occurs when incorrect conditions or improper handling of external integrations lead to contract functions being interrupted or rendered unusable.</p><h3 id="logic-error-vulnerability-example"><a href="#logic-error-vulnerability-example" class="direct-link">#</a> Logic Error Vulnerability Example</h3><p>The contract contains a function that allows setting a number.</p><pre class="language-solidity"><code class="language-solidity"><span class="token comment">// SPDX-License-Identifier: MIT</span><br><span class="token keyword">pragma</span> <span class="token keyword">solidity</span> <span class="token operator">^</span> <span class="token number">0.8</span> <span class="token number">.0</span><span class="token punctuation">;</span><br><br><span class="token keyword">contract</span> <span class="token class-name">setNumber</span> <span class="token punctuation">{</span><br>  <span class="token builtin">uint256</span> returnValue<span class="token punctuation">;</span><br><br>  <span class="token keyword">function</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> _value<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span><br>    <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span>balance <span class="token operator">&lt;=</span> <span class="token number">1</span> ether<span class="token punctuation">,</span> <span class="token string">"Function cannot be used anymore due to high contract balance"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    returnValue <span class="token operator">=</span> _value<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">receive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">payable</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h3 id="details-of-the-logic-error-vulnerability-example"><a href="#details-of-the-logic-error-vulnerability-example" class="direct-link">#</a> Details of the Logic Error Vulnerability Example</h3><p>Due to using the contract balance <code>address(this).balance &lt;= 1 ether</code> as a condition, if unexpected Ether is sent, causing the contract balance to exceed 1 Ether, it will permanently block the <code>setValue()</code> function.</p><h3 id="integration-error-vulnerability-example"><a href="#integration-error-vulnerability-example" class="direct-link">#</a> Integration Error Vulnerability Example</h3><p>The contract contains a function for cross-chain settlement.</p><pre class="language-solidity"><code class="language-solidity"><span class="token comment">/**<br> * @notice Settles claimed tokens to any valid Connext domain.<br> * @dev permissions are not checked: call only after a valid claim is executed<br> * @param _recipient: the address that will receive tokens<br> * @param _recipientDomain: the domain of the address that will receive tokens<br> * @param _amount: the amount of claims to settle<br> */</span><br><span class="token keyword">function</span> <span class="token function">_settleClaim</span><span class="token punctuation">(</span><br>  <span class="token builtin">address</span> _beneficiary<span class="token punctuation">,</span><br>  <span class="token builtin">address</span> _recipient<span class="token punctuation">,</span><br>  <span class="token builtin">uint32</span> _recipientDomain<span class="token punctuation">,</span><br>  <span class="token builtin">uint256</span> _amount<br><span class="token punctuation">)</span> <span class="token keyword">internal</span> virtual <span class="token punctuation">{</span><br>  <span class="token builtin">bytes32</span> id<span class="token punctuation">;</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>_recipientDomain <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> _recipientDomain <span class="token operator">==</span> domain<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    token<span class="token punctuation">.</span><span class="token function">safeTransfer</span><span class="token punctuation">(</span>_recipient<span class="token punctuation">,</span> _amount<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    id <span class="token operator">=</span> connext<span class="token punctuation">.</span><span class="token function">xcall</span><span class="token punctuation">(</span><br>      _recipientDomain<span class="token punctuation">,</span> <span class="token comment">// destination domain</span><br>      _recipient<span class="token punctuation">,</span> <span class="token comment">// to</span><br>      <span class="token builtin">address</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// asset</span><br>      _recipient<span class="token punctuation">,</span> <span class="token comment">// delegate, only required for self-execution + slippage</span><br>      _amount<span class="token punctuation">,</span> <span class="token comment">// amount</span><br>      <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// slippage -- assumes no pools on connext</span><br>      <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token comment">// calldata</span><br>    <span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br>  <span class="token keyword">emit</span> <span class="token function">CrosschainClaim</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> _beneficiary<span class="token punctuation">,</span> _recipient<span class="token punctuation">,</span> _recipientDomain<span class="token punctuation">,</span> _amount<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h3 id="background-knowledge-of-integration-error-vulnerability-example"><a href="#background-knowledge-of-integration-error-vulnerability-example" class="direct-link">#</a> Background knowledge of Integration Error Vulnerability Example</h3><p><strong>What is Connext ?</strong></p><p><a href="https://docs.connext.network/" rel="noopener noreferrer" target="_blank">Connext</a> is a modular protocol used to transfer funds and data between chains. Developers can use Connext to build cross-chain applications.</p><p><strong>The usage of xcall</strong></p><p>The purpose of Connext's xcall is to enable cross-chain calls, data transfer, and cross-chain asset transfers. When performing cross-chain operations using xcall, <a href="https://docs.connext.network/developers/guides/estimating-fees" rel="noopener noreferrer" target="_blank">two types</a> of fees need to be paid to the off-chain agents, and the fees are paid in native assets:</p><ol><li>Router fee</li><li>Relayer fee</li></ol><h3 id="details-of-the-integration-error-vulnerability-example"><a href="#details-of-the-integration-error-vulnerability-example" class="direct-link">#</a> Details of the Integration Error Vulnerability Example</h3><p>When using xcall, the lack of payment for the relayer fee results in the failure to complete the cross-chain asset settlement. The claimed tokens will never be transferred to the beneficiary's wallet on the target chain, causing the cross-chain settlement function to fail.</p><h2 id="refund-failed"><a href="#refund-failed" class="direct-link">#</a> Refund failed</h2><p>This type of vulnerability often occurs when a smart contract attempts to refund a previous user/contract, and the recipient is unable to accept the refund, leading to the contract's functionality being permanently blocked. A classic example is <a href="https://github.com/NorthPoleYuri/web3SecurityCourses/blob/main/src/dos_example/king.sol" rel="noopener noreferrer" target="_blank">King of the Ether</a></p><h3 id="refund-failed-vulnerability-example"><a href="#refund-failed-vulnerability-example" class="direct-link">#</a> Refund failed Vulnerability Example</h3><p>The contract contains a withdrawal function that distributes specified funds proportionally to multiple recipients.</p><pre class="language-solidity"><code class="language-solidity"><span class="token keyword">function</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token builtin">uint256</span> amount<span class="token punctuation">,</span> <span class="token builtin">address</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">memory</span> recipients<span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token punctuation">{</span><br>  <span class="token keyword">require</span><span class="token punctuation">(</span>recipients<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"No recipients provided"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">require</span><span class="token punctuation">(</span>recipients<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"Too many recipients"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token builtin">uint256</span> recipientAmount <span class="token operator">=</span> amount <span class="token operator">/</span> recipients<span class="token punctuation">.</span>length<span class="token punctuation">;</span><br>  <span class="token keyword">require</span><span class="token punctuation">(</span>recipientAmount <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"Amount too small to split"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token builtin">uint256</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> recipients<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">require</span><span class="token punctuation">(</span>recipients<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token builtin">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Invalid recipient address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    token<span class="token punctuation">.</span><span class="token function">safeTransfer</span><span class="token punctuation">(</span>recipients<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> recipientAmount<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><h3 id="background-knowledge-of-refund-failed-vulnerability-example"><a href="#background-knowledge-of-refund-failed-vulnerability-example" class="direct-link">#</a> Background knowledge of Refund failed Vulnerability Example</h3><h3 id="weird-erc20-tokens"><a href="#weird-erc20-tokens" class="direct-link">#</a> Weird ERC20 tokens</h3><p>It is quite common to implement blacklisted tokens. Some tokens (such as USDC, USDT) have contract-level administrator-controlled address blacklists. If an address is blacklisted, it is prohibited from sending tokens to or transferring tokens out of that address.</p><p>Malicious or compromised token owners can trap funds in a contract by adding the contract address to the blacklist.</p><h3 id="erc777-tokens-that-are-compatible-with-erc20."><a href="#erc777-tokens-that-are-compatible-with-erc20." class="direct-link">#</a> ERC777 tokens that are compatible with ERC20.</h3><p>ERC777 is compatible with ERC20, and it implements <code>tokensReceived</code> via the ERC1820 registry. Malicious users can invoke <code>tokensReceived</code> and reject token transfers, causing the transaction to fail and trapping the funds.</p><h3 id="details-of-the-refund-failed-vulnerability-example"><a href="#details-of-the-refund-failed-vulnerability-example" class="direct-link">#</a> Details of the Refund failed Vulnerability Example</h3><p>Due to the use of <code>safeTransfer</code> in the loop, if any recipient in the <code>recipients</code> list is blacklisted or if a user receiving ERC777 tokens implements a <code>revert</code> in <code>tokensReceived</code>, the withdrawal process will be blocked. As a result, even if other recipients are normal and legitimate users, they will not be able to receive their entitled funds.</p><h2 id="how-to-avoid-dos"><a href="#how-to-avoid-dos" class="direct-link">#</a> How to avoid DoS</h2><p>Consider all possible logical or integration errors, edge cases, and dependencies on external protocols when designing robust processes to prevent irreversible financial losses or operational interruptions caused by DoS. Whether in the operation of your own protocol or when providing integration support for other protocols, this ensures system stability and compatibility on both sides. Comprehensive testing of all use cases can help ensure the availability of all contract functions.</p><div class="article-footer"><a href="https://tech-blog.cymetrics.io/en/posts/alice/solidiyDoS_en/" on-click="share"><img alt="Share" src="/img/icons/icon_external link hyperlink.svg" height="24" width="24">Share this post</a></div><div><p style="font-weight: bold;">Tag</p><div class="post-tags"><a href="/en/tags/postsen/" class="post-tag">#postsEn</a> <a href="/en/tags/blockchain/" class="post-tag">#Blockchain</a> <a href="/en/tags/solidity/" class="post-tag">#Solidity</a></div><p style="font-weight: bold;">Recommendation</p><ol><li><a href="/en/posts/nick/chatgpt_basic_en/">ChatGPT Hacking Basics</a></li><li><a href="/en/posts/seadog007/supply-chain-attack/">What is Supply Chain Attack?</a></li><li><a href="/en/posts/cymetrics/critical-java-0day-spring4shell/">Spring4shell - a new critical RCE vulnerability found in Java Spring Framework</a></li><li><a href="/en/posts/huli/why-can-i-only-reset-password/">Why can I only reset the password when I forget it and the system couldn’t tell me my old password?</a></li><li><a href="/en/posts/genchilu/javas-thread-model-and-golang-goroutine-en/">Java’s Thread Model and Golang Goroutine</a></li></ol></div><div class="article-author"><img alt="AliceHsu" src="/img/authors/alice_logo.jpg" class="article-author__img" data-deopt="true"><div class="article-author__info"><div class="article-author__title">Author</div><div class="article-author__author"><a href="/en/posts/alice">AliceHsu</a></div><div class="article-author__intro">OP and white hat @DeFiHackLabs</div></div></div><p style="font-weight: bold;">Discussion(login required)</p><script async="" src="https://utteranc.es/client.js" crossorigin="anonymous" id="utterance-script" issue-term="title" label="utterance" repo="cymetrics/blog" theme="github-light"></script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Decoding DoS Attacks in Solidity: Security Vulnerabilities and Prevention Strategies.","image":["https://tech-blog.cymetrics.io/img/posts/alice/solidityDoS/solidityDos-1920w.png","https://tech-blog.cymetrics.io/img/icons/icon_external link hyperlink.svg","https://tech-blog.cymetrics.io/img/authors/alice_logo.jpg"],"author":{"@type":"Person","name":"AliceHsu"},"publisher":{"@type":"Organization","name":"Cymetrics Tech Blog","url":"https://tech-blog.cymetrics.io","logo":{"@type":"ImageObject","url":"https://tech-blog.cymetrics.io/img/favicon/favicon-512x512.png","width":512,"height":512}},"url":"https://tech-blog.cymetrics.io/en/posts/alice/solidiyDoS_en/","mainEntityOfPage":"https://tech-blog.cymetrics.io/en/posts/alice/solidiyDoS_en/","datePublished":"2024-10-17","dateModified":"2024-10-31","description":"# What is Denial of Service ? In Solidity, Denial of Service (DoS) is a common vulnerability type that disrupts the expected execution of..."}</script></article></main><footer><div class="footer-logos"><a href="https://www.facebook.com/cymetrics" rel="noopener noreferrer" target="_blank"><img alt="facebook" src="/img/icons/icon_social media_facebook.svg" height="30" width="30"></a><a href="https://www.linkedin.com/company/cymetrics" rel="noopener noreferrer" target="_blank"><img alt="linkedin" src="/img/icons/icon_social media_linkedln.svg" height="30" width="30"></a><a href="https://tech-blog.cymetrics.io/feed/feed.xml" rel="noreferrer noopener" target="_blank"><img alt="rss feed" src="/img/icons/rss-feed.svg" height="30" width="30"></a></div><div class="copyright">© 2021 Cymetrics Tech Blog, based on <a href="https://github.com/google/eleventy-high-performance-blog" rel="noopener noreferrer" target="_blank">eleventy-high-performance-blog</a>. <a href="https://oneinfinity.global/" rel="noopener noreferrer" target="_blank">OneInfinity</a></div></footer><script>const menuBtn = document.querySelector('.menu__btn')
      menuBtn.addEventListener('click', function() {
        document.querySelector('body').classList.toggle('lock')
        menuBtn.classList.toggle('menu__btn--close');
        document.querySelector('.nav__links').classList.toggle('nav__links--open')
      })</script></body></html>